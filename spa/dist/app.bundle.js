/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "../node_modules/moment/locale sync recursive ^\\.\\/.*$":
/*!****************************************************!*\
  !*** ../node_modules/moment/locale/ sync ^\.\/.*$ ***!
  \****************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var map = {
	"./af": "../node_modules/moment/locale/af.js",
	"./af.js": "../node_modules/moment/locale/af.js",
	"./ar": "../node_modules/moment/locale/ar.js",
	"./ar-dz": "../node_modules/moment/locale/ar-dz.js",
	"./ar-dz.js": "../node_modules/moment/locale/ar-dz.js",
	"./ar-kw": "../node_modules/moment/locale/ar-kw.js",
	"./ar-kw.js": "../node_modules/moment/locale/ar-kw.js",
	"./ar-ly": "../node_modules/moment/locale/ar-ly.js",
	"./ar-ly.js": "../node_modules/moment/locale/ar-ly.js",
	"./ar-ma": "../node_modules/moment/locale/ar-ma.js",
	"./ar-ma.js": "../node_modules/moment/locale/ar-ma.js",
	"./ar-sa": "../node_modules/moment/locale/ar-sa.js",
	"./ar-sa.js": "../node_modules/moment/locale/ar-sa.js",
	"./ar-tn": "../node_modules/moment/locale/ar-tn.js",
	"./ar-tn.js": "../node_modules/moment/locale/ar-tn.js",
	"./ar.js": "../node_modules/moment/locale/ar.js",
	"./az": "../node_modules/moment/locale/az.js",
	"./az.js": "../node_modules/moment/locale/az.js",
	"./be": "../node_modules/moment/locale/be.js",
	"./be.js": "../node_modules/moment/locale/be.js",
	"./bg": "../node_modules/moment/locale/bg.js",
	"./bg.js": "../node_modules/moment/locale/bg.js",
	"./bm": "../node_modules/moment/locale/bm.js",
	"./bm.js": "../node_modules/moment/locale/bm.js",
	"./bn": "../node_modules/moment/locale/bn.js",
	"./bn-bd": "../node_modules/moment/locale/bn-bd.js",
	"./bn-bd.js": "../node_modules/moment/locale/bn-bd.js",
	"./bn.js": "../node_modules/moment/locale/bn.js",
	"./bo": "../node_modules/moment/locale/bo.js",
	"./bo.js": "../node_modules/moment/locale/bo.js",
	"./br": "../node_modules/moment/locale/br.js",
	"./br.js": "../node_modules/moment/locale/br.js",
	"./bs": "../node_modules/moment/locale/bs.js",
	"./bs.js": "../node_modules/moment/locale/bs.js",
	"./ca": "../node_modules/moment/locale/ca.js",
	"./ca.js": "../node_modules/moment/locale/ca.js",
	"./cs": "../node_modules/moment/locale/cs.js",
	"./cs.js": "../node_modules/moment/locale/cs.js",
	"./cv": "../node_modules/moment/locale/cv.js",
	"./cv.js": "../node_modules/moment/locale/cv.js",
	"./cy": "../node_modules/moment/locale/cy.js",
	"./cy.js": "../node_modules/moment/locale/cy.js",
	"./da": "../node_modules/moment/locale/da.js",
	"./da.js": "../node_modules/moment/locale/da.js",
	"./de": "../node_modules/moment/locale/de.js",
	"./de-at": "../node_modules/moment/locale/de-at.js",
	"./de-at.js": "../node_modules/moment/locale/de-at.js",
	"./de-ch": "../node_modules/moment/locale/de-ch.js",
	"./de-ch.js": "../node_modules/moment/locale/de-ch.js",
	"./de.js": "../node_modules/moment/locale/de.js",
	"./dv": "../node_modules/moment/locale/dv.js",
	"./dv.js": "../node_modules/moment/locale/dv.js",
	"./el": "../node_modules/moment/locale/el.js",
	"./el.js": "../node_modules/moment/locale/el.js",
	"./en-au": "../node_modules/moment/locale/en-au.js",
	"./en-au.js": "../node_modules/moment/locale/en-au.js",
	"./en-ca": "../node_modules/moment/locale/en-ca.js",
	"./en-ca.js": "../node_modules/moment/locale/en-ca.js",
	"./en-gb": "../node_modules/moment/locale/en-gb.js",
	"./en-gb.js": "../node_modules/moment/locale/en-gb.js",
	"./en-ie": "../node_modules/moment/locale/en-ie.js",
	"./en-ie.js": "../node_modules/moment/locale/en-ie.js",
	"./en-il": "../node_modules/moment/locale/en-il.js",
	"./en-il.js": "../node_modules/moment/locale/en-il.js",
	"./en-in": "../node_modules/moment/locale/en-in.js",
	"./en-in.js": "../node_modules/moment/locale/en-in.js",
	"./en-nz": "../node_modules/moment/locale/en-nz.js",
	"./en-nz.js": "../node_modules/moment/locale/en-nz.js",
	"./en-sg": "../node_modules/moment/locale/en-sg.js",
	"./en-sg.js": "../node_modules/moment/locale/en-sg.js",
	"./eo": "../node_modules/moment/locale/eo.js",
	"./eo.js": "../node_modules/moment/locale/eo.js",
	"./es": "../node_modules/moment/locale/es.js",
	"./es-do": "../node_modules/moment/locale/es-do.js",
	"./es-do.js": "../node_modules/moment/locale/es-do.js",
	"./es-mx": "../node_modules/moment/locale/es-mx.js",
	"./es-mx.js": "../node_modules/moment/locale/es-mx.js",
	"./es-us": "../node_modules/moment/locale/es-us.js",
	"./es-us.js": "../node_modules/moment/locale/es-us.js",
	"./es.js": "../node_modules/moment/locale/es.js",
	"./et": "../node_modules/moment/locale/et.js",
	"./et.js": "../node_modules/moment/locale/et.js",
	"./eu": "../node_modules/moment/locale/eu.js",
	"./eu.js": "../node_modules/moment/locale/eu.js",
	"./fa": "../node_modules/moment/locale/fa.js",
	"./fa.js": "../node_modules/moment/locale/fa.js",
	"./fi": "../node_modules/moment/locale/fi.js",
	"./fi.js": "../node_modules/moment/locale/fi.js",
	"./fil": "../node_modules/moment/locale/fil.js",
	"./fil.js": "../node_modules/moment/locale/fil.js",
	"./fo": "../node_modules/moment/locale/fo.js",
	"./fo.js": "../node_modules/moment/locale/fo.js",
	"./fr": "../node_modules/moment/locale/fr.js",
	"./fr-ca": "../node_modules/moment/locale/fr-ca.js",
	"./fr-ca.js": "../node_modules/moment/locale/fr-ca.js",
	"./fr-ch": "../node_modules/moment/locale/fr-ch.js",
	"./fr-ch.js": "../node_modules/moment/locale/fr-ch.js",
	"./fr.js": "../node_modules/moment/locale/fr.js",
	"./fy": "../node_modules/moment/locale/fy.js",
	"./fy.js": "../node_modules/moment/locale/fy.js",
	"./ga": "../node_modules/moment/locale/ga.js",
	"./ga.js": "../node_modules/moment/locale/ga.js",
	"./gd": "../node_modules/moment/locale/gd.js",
	"./gd.js": "../node_modules/moment/locale/gd.js",
	"./gl": "../node_modules/moment/locale/gl.js",
	"./gl.js": "../node_modules/moment/locale/gl.js",
	"./gom-deva": "../node_modules/moment/locale/gom-deva.js",
	"./gom-deva.js": "../node_modules/moment/locale/gom-deva.js",
	"./gom-latn": "../node_modules/moment/locale/gom-latn.js",
	"./gom-latn.js": "../node_modules/moment/locale/gom-latn.js",
	"./gu": "../node_modules/moment/locale/gu.js",
	"./gu.js": "../node_modules/moment/locale/gu.js",
	"./he": "../node_modules/moment/locale/he.js",
	"./he.js": "../node_modules/moment/locale/he.js",
	"./hi": "../node_modules/moment/locale/hi.js",
	"./hi.js": "../node_modules/moment/locale/hi.js",
	"./hr": "../node_modules/moment/locale/hr.js",
	"./hr.js": "../node_modules/moment/locale/hr.js",
	"./hu": "../node_modules/moment/locale/hu.js",
	"./hu.js": "../node_modules/moment/locale/hu.js",
	"./hy-am": "../node_modules/moment/locale/hy-am.js",
	"./hy-am.js": "../node_modules/moment/locale/hy-am.js",
	"./id": "../node_modules/moment/locale/id.js",
	"./id.js": "../node_modules/moment/locale/id.js",
	"./is": "../node_modules/moment/locale/is.js",
	"./is.js": "../node_modules/moment/locale/is.js",
	"./it": "../node_modules/moment/locale/it.js",
	"./it-ch": "../node_modules/moment/locale/it-ch.js",
	"./it-ch.js": "../node_modules/moment/locale/it-ch.js",
	"./it.js": "../node_modules/moment/locale/it.js",
	"./ja": "../node_modules/moment/locale/ja.js",
	"./ja.js": "../node_modules/moment/locale/ja.js",
	"./jv": "../node_modules/moment/locale/jv.js",
	"./jv.js": "../node_modules/moment/locale/jv.js",
	"./ka": "../node_modules/moment/locale/ka.js",
	"./ka.js": "../node_modules/moment/locale/ka.js",
	"./kk": "../node_modules/moment/locale/kk.js",
	"./kk.js": "../node_modules/moment/locale/kk.js",
	"./km": "../node_modules/moment/locale/km.js",
	"./km.js": "../node_modules/moment/locale/km.js",
	"./kn": "../node_modules/moment/locale/kn.js",
	"./kn.js": "../node_modules/moment/locale/kn.js",
	"./ko": "../node_modules/moment/locale/ko.js",
	"./ko.js": "../node_modules/moment/locale/ko.js",
	"./ku": "../node_modules/moment/locale/ku.js",
	"./ku.js": "../node_modules/moment/locale/ku.js",
	"./ky": "../node_modules/moment/locale/ky.js",
	"./ky.js": "../node_modules/moment/locale/ky.js",
	"./lb": "../node_modules/moment/locale/lb.js",
	"./lb.js": "../node_modules/moment/locale/lb.js",
	"./lo": "../node_modules/moment/locale/lo.js",
	"./lo.js": "../node_modules/moment/locale/lo.js",
	"./lt": "../node_modules/moment/locale/lt.js",
	"./lt.js": "../node_modules/moment/locale/lt.js",
	"./lv": "../node_modules/moment/locale/lv.js",
	"./lv.js": "../node_modules/moment/locale/lv.js",
	"./me": "../node_modules/moment/locale/me.js",
	"./me.js": "../node_modules/moment/locale/me.js",
	"./mi": "../node_modules/moment/locale/mi.js",
	"./mi.js": "../node_modules/moment/locale/mi.js",
	"./mk": "../node_modules/moment/locale/mk.js",
	"./mk.js": "../node_modules/moment/locale/mk.js",
	"./ml": "../node_modules/moment/locale/ml.js",
	"./ml.js": "../node_modules/moment/locale/ml.js",
	"./mn": "../node_modules/moment/locale/mn.js",
	"./mn.js": "../node_modules/moment/locale/mn.js",
	"./mr": "../node_modules/moment/locale/mr.js",
	"./mr.js": "../node_modules/moment/locale/mr.js",
	"./ms": "../node_modules/moment/locale/ms.js",
	"./ms-my": "../node_modules/moment/locale/ms-my.js",
	"./ms-my.js": "../node_modules/moment/locale/ms-my.js",
	"./ms.js": "../node_modules/moment/locale/ms.js",
	"./mt": "../node_modules/moment/locale/mt.js",
	"./mt.js": "../node_modules/moment/locale/mt.js",
	"./my": "../node_modules/moment/locale/my.js",
	"./my.js": "../node_modules/moment/locale/my.js",
	"./nb": "../node_modules/moment/locale/nb.js",
	"./nb.js": "../node_modules/moment/locale/nb.js",
	"./ne": "../node_modules/moment/locale/ne.js",
	"./ne.js": "../node_modules/moment/locale/ne.js",
	"./nl": "../node_modules/moment/locale/nl.js",
	"./nl-be": "../node_modules/moment/locale/nl-be.js",
	"./nl-be.js": "../node_modules/moment/locale/nl-be.js",
	"./nl.js": "../node_modules/moment/locale/nl.js",
	"./nn": "../node_modules/moment/locale/nn.js",
	"./nn.js": "../node_modules/moment/locale/nn.js",
	"./oc-lnc": "../node_modules/moment/locale/oc-lnc.js",
	"./oc-lnc.js": "../node_modules/moment/locale/oc-lnc.js",
	"./pa-in": "../node_modules/moment/locale/pa-in.js",
	"./pa-in.js": "../node_modules/moment/locale/pa-in.js",
	"./pl": "../node_modules/moment/locale/pl.js",
	"./pl.js": "../node_modules/moment/locale/pl.js",
	"./pt": "../node_modules/moment/locale/pt.js",
	"./pt-br": "../node_modules/moment/locale/pt-br.js",
	"./pt-br.js": "../node_modules/moment/locale/pt-br.js",
	"./pt.js": "../node_modules/moment/locale/pt.js",
	"./ro": "../node_modules/moment/locale/ro.js",
	"./ro.js": "../node_modules/moment/locale/ro.js",
	"./ru": "../node_modules/moment/locale/ru.js",
	"./ru.js": "../node_modules/moment/locale/ru.js",
	"./sd": "../node_modules/moment/locale/sd.js",
	"./sd.js": "../node_modules/moment/locale/sd.js",
	"./se": "../node_modules/moment/locale/se.js",
	"./se.js": "../node_modules/moment/locale/se.js",
	"./si": "../node_modules/moment/locale/si.js",
	"./si.js": "../node_modules/moment/locale/si.js",
	"./sk": "../node_modules/moment/locale/sk.js",
	"./sk.js": "../node_modules/moment/locale/sk.js",
	"./sl": "../node_modules/moment/locale/sl.js",
	"./sl.js": "../node_modules/moment/locale/sl.js",
	"./sq": "../node_modules/moment/locale/sq.js",
	"./sq.js": "../node_modules/moment/locale/sq.js",
	"./sr": "../node_modules/moment/locale/sr.js",
	"./sr-cyrl": "../node_modules/moment/locale/sr-cyrl.js",
	"./sr-cyrl.js": "../node_modules/moment/locale/sr-cyrl.js",
	"./sr.js": "../node_modules/moment/locale/sr.js",
	"./ss": "../node_modules/moment/locale/ss.js",
	"./ss.js": "../node_modules/moment/locale/ss.js",
	"./sv": "../node_modules/moment/locale/sv.js",
	"./sv.js": "../node_modules/moment/locale/sv.js",
	"./sw": "../node_modules/moment/locale/sw.js",
	"./sw.js": "../node_modules/moment/locale/sw.js",
	"./ta": "../node_modules/moment/locale/ta.js",
	"./ta.js": "../node_modules/moment/locale/ta.js",
	"./te": "../node_modules/moment/locale/te.js",
	"./te.js": "../node_modules/moment/locale/te.js",
	"./tet": "../node_modules/moment/locale/tet.js",
	"./tet.js": "../node_modules/moment/locale/tet.js",
	"./tg": "../node_modules/moment/locale/tg.js",
	"./tg.js": "../node_modules/moment/locale/tg.js",
	"./th": "../node_modules/moment/locale/th.js",
	"./th.js": "../node_modules/moment/locale/th.js",
	"./tk": "../node_modules/moment/locale/tk.js",
	"./tk.js": "../node_modules/moment/locale/tk.js",
	"./tl-ph": "../node_modules/moment/locale/tl-ph.js",
	"./tl-ph.js": "../node_modules/moment/locale/tl-ph.js",
	"./tlh": "../node_modules/moment/locale/tlh.js",
	"./tlh.js": "../node_modules/moment/locale/tlh.js",
	"./tr": "../node_modules/moment/locale/tr.js",
	"./tr.js": "../node_modules/moment/locale/tr.js",
	"./tzl": "../node_modules/moment/locale/tzl.js",
	"./tzl.js": "../node_modules/moment/locale/tzl.js",
	"./tzm": "../node_modules/moment/locale/tzm.js",
	"./tzm-latn": "../node_modules/moment/locale/tzm-latn.js",
	"./tzm-latn.js": "../node_modules/moment/locale/tzm-latn.js",
	"./tzm.js": "../node_modules/moment/locale/tzm.js",
	"./ug-cn": "../node_modules/moment/locale/ug-cn.js",
	"./ug-cn.js": "../node_modules/moment/locale/ug-cn.js",
	"./uk": "../node_modules/moment/locale/uk.js",
	"./uk.js": "../node_modules/moment/locale/uk.js",
	"./ur": "../node_modules/moment/locale/ur.js",
	"./ur.js": "../node_modules/moment/locale/ur.js",
	"./uz": "../node_modules/moment/locale/uz.js",
	"./uz-latn": "../node_modules/moment/locale/uz-latn.js",
	"./uz-latn.js": "../node_modules/moment/locale/uz-latn.js",
	"./uz.js": "../node_modules/moment/locale/uz.js",
	"./vi": "../node_modules/moment/locale/vi.js",
	"./vi.js": "../node_modules/moment/locale/vi.js",
	"./x-pseudo": "../node_modules/moment/locale/x-pseudo.js",
	"./x-pseudo.js": "../node_modules/moment/locale/x-pseudo.js",
	"./yo": "../node_modules/moment/locale/yo.js",
	"./yo.js": "../node_modules/moment/locale/yo.js",
	"./zh-cn": "../node_modules/moment/locale/zh-cn.js",
	"./zh-cn.js": "../node_modules/moment/locale/zh-cn.js",
	"./zh-hk": "../node_modules/moment/locale/zh-hk.js",
	"./zh-hk.js": "../node_modules/moment/locale/zh-hk.js",
	"./zh-mo": "../node_modules/moment/locale/zh-mo.js",
	"./zh-mo.js": "../node_modules/moment/locale/zh-mo.js",
	"./zh-tw": "../node_modules/moment/locale/zh-tw.js",
	"./zh-tw.js": "../node_modules/moment/locale/zh-tw.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "../node_modules/moment/locale sync recursive ^\\.\\/.*$";

/***/ }),

/***/ "./api/client/apiClient.ts":
/*!*********************************!*\
  !*** ./api/client/apiClient.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ApiClient": () => (/* binding */ ApiClient)
/* harmony export */ });
/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ "../node_modules/axios/index.js");
/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var guid_typescript__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! guid-typescript */ "../node_modules/guid-typescript/dist/guid.js");
/* harmony import */ var _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plumbing/errors/errorHandler */ "./plumbing/errors/errorHandler.ts");
/* harmony import */ var _plumbing_utilities_axiosUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plumbing/utilities/axiosUtils */ "./plumbing/utilities/axiosUtils.ts");
/* harmony import */ var _plumbing_utilities_sessionManager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plumbing/utilities/sessionManager */ "./plumbing/utilities/sessionManager.ts");





/*
 * Logic related to making API calls
 */
class ApiClient {
    constructor(apiBaseUrl, authenticator) {
        this._apiBaseUrl = apiBaseUrl;
        if (!this._apiBaseUrl.endsWith('/')) {
            this._apiBaseUrl += '/';
        }
        this._authenticator = authenticator;
        this._sessionId = _plumbing_utilities_sessionManager__WEBPACK_IMPORTED_MODULE_4__.SessionManager.get();
    }
    /*
     * We download user info from the API rather than using the id token
     */
    async getUserInfo(options) {
        return await this._callApi('userclaims/current', 'GET', null, options);
    }
    /*
     * Get a list of companies
     */
    async getCompanyList(options) {
        return await this._callApi('companies', 'GET', null, options);
    }
    /*
     * Get a list of transactions for a single company
     */
    async getCompanyTransactions(id, options) {
        return await this._callApi(`companies/${id}/transactions`, 'GET', null, options);
    }
    /*
     * A central method to get data from an API and handle 401 retries
     */
    async _callApi(path, method, dataToSend, options) {
        // Get the full path
        const url = `${this._apiBaseUrl}${path}`;
        // Get the access token, and if it does not exist a login redirect will be triggered
        let token = await this._authenticator.getAccessToken();
        try {
            // Call the API
            return await this._callApiWithToken(url, method, dataToSend, token, options);
        }
        catch (error1) {
            // Report Ajax errors if this is not a 401
            if (!this._isApi401Error(error1)) {
                throw _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_2__.ErrorHandler.getFromHttpError(error1, url, 'Web API');
            }
            // If we received a 401 then try to get a new token
            token = await this._authenticator.refreshAccessToken();
            // The general pattern for calling an OAuth secured API is to retry 401s once with a new token
            try {
                // Call the API again
                return await this._callApiWithToken(url, method, dataToSend, token, options);
            }
            catch (error2) {
                // Report Ajax errors for the retry
                throw _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_2__.ErrorHandler.getFromHttpError(error2, url, 'Web API');
            }
        }
    }
    /*
     * Do the work of calling the API
     */
    async _callApiWithToken(url, method, dataToSend, accessToken, options) {
        // Force IE11 to bypass the browser cache by changing the request URL every time
        let requestUrl = url;
        if (navigator.userAgent.toLowerCase().indexOf('trident') !== -1) {
            requestUrl += `?time=${new Date().getTime()}`;
        }
        const response = await axios__WEBPACK_IMPORTED_MODULE_0___default().request({
            url: requestUrl,
            method,
            data: dataToSend,
            headers: this._getHeaders(accessToken, options),
        });
        _plumbing_utilities_axiosUtils__WEBPACK_IMPORTED_MODULE_3__.AxiosUtils.checkJson(response.data);
        return response.data;
    }
    /*
     * Add headers for logging and advanced testing purposes
     */
    _getHeaders(accessToken, options) {
        const headers = {
            // The required authorization header
            'Authorization': `Bearer ${accessToken}`,
            // Context headers included in API logs
            'x-mycompany-api-client': 'FinalSPA',
            'x-mycompany-session-id': this._sessionId,
            'x-mycompany-correlation-id': guid_typescript__WEBPACK_IMPORTED_MODULE_1__.Guid.create().toString(),
        };
        // A special header can be sent to ask the API to throw a simulated exception
        if (options && options.causeError) {
            headers['x-mycompany-test-exception'] = 'SampleApi';
        }
        return headers;
    }
    /*
     * API 401s are handled via a retry with a new token
     */
    _isApi401Error(error) {
        if (error.response && error.response.status === 401) {
            return true;
        }
        return false;
    }
}


/***/ }),

/***/ "./app/app.tsx":
/*!*********************!*\
  !*** ./app/app.tsx ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "App": () => (/* binding */ App)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var react_modal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-modal */ "../node_modules/react-modal/lib/index.js");
/* harmony import */ var react_modal__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_modal__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! react-router-dom */ "../node_modules/react-router-dom/esm/react-router-dom.js");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! react-router-dom */ "../node_modules/react-router/esm/react-router.js");
/* harmony import */ var _api_client_apiClient__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../api/client/apiClient */ "./api/client/apiClient.ts");
/* harmony import */ var _configuration_configurationLoader__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../configuration/configurationLoader */ "./configuration/configurationLoader.ts");
/* harmony import */ var _plumbing_errors_errorConsoleReporter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../plumbing/errors/errorConsoleReporter */ "./plumbing/errors/errorConsoleReporter.ts");
/* harmony import */ var _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../plumbing/errors/errorCodes */ "./plumbing/errors/errorCodes.ts");
/* harmony import */ var _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../plumbing/errors/errorHandler */ "./plumbing/errors/errorHandler.ts");
/* harmony import */ var _plumbing_events_eventEmitter__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../plumbing/events/eventEmitter */ "./plumbing/events/eventEmitter.ts");
/* harmony import */ var _plumbing_events_eventNames__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../plumbing/events/eventNames */ "./plumbing/events/eventNames.ts");
/* harmony import */ var _plumbing_oauth_authenticatorFactory__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../plumbing/oauth/authenticatorFactory */ "./plumbing/oauth/authenticatorFactory.ts");
/* harmony import */ var _views_companies_companiesContainer__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../views/companies/companiesContainer */ "./views/companies/companiesContainer.tsx");
/* harmony import */ var _views_errors_errorBoundary__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../views/errors/errorBoundary */ "./views/errors/errorBoundary.tsx");
/* harmony import */ var _views_errors_errorSummaryView__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../views/errors/errorSummaryView */ "./views/errors/errorSummaryView.tsx");
/* harmony import */ var _views_headings_headerButtonsView__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../views/headings/headerButtonsView */ "./views/headings/headerButtonsView.tsx");
/* harmony import */ var _views_headings_sessionView__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../views/headings/sessionView */ "./views/headings/sessionView.tsx");
/* harmony import */ var _views_headings_titleView__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../views/headings/titleView */ "./views/headings/titleView.tsx");
/* harmony import */ var _views_loginRequired_loginRequiredView__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../views/loginRequired/loginRequiredView */ "./views/loginRequired/loginRequiredView.tsx");
/* harmony import */ var _views_transactions_transactionsContainer__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../views/transactions/transactionsContainer */ "./views/transactions/transactionsContainer.tsx");
/* harmony import */ var _views_utilities_apiViewEvents__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../views/utilities/apiViewEvents */ "./views/utilities/apiViewEvents.ts");
/* harmony import */ var _views_utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../views/utilities/apiViewNames */ "./views/utilities/apiViewNames.ts");
/* harmony import */ var _views_utilities_routeHelper__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../views/utilities/routeHelper */ "./views/utilities/routeHelper.ts");






















/*
 * The application root component
 */
class App extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    /*
     * Create safe objects here and do async startup processing later
     */
    constructor(props) {
        super(props);
        // Set initial state, which will be used on the first render
        this.state = {
            isInitialised: false,
            isInLoggedOutView: false,
            isMainViewLoaded: false,
            isMobileSize: this._isMobileSize(),
            error: null,
        };
        // Make callbacks available
        this._setupCallbacks();
        // Create a helper class to notify us about views that make API calls
        // This will enable us to only trigger a login redirect once, after all views have tried to load
        this._apiViewEvents = new _views_utilities_apiViewEvents__WEBPACK_IMPORTED_MODULE_18__.ApiViewEvents(this._onLoginRequired, this._onMainViewLoadStateChanged);
        this._apiViewEvents.addView(_views_utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_19__.ApiViewNames.Main);
        this._apiViewEvents.addView(_views_utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_19__.ApiViewNames.UserInfo);
        // Initialise the modal dialog system used for error popups
        react_modal__WEBPACK_IMPORTED_MODULE_1___default().setAppElement('#root');
    }
    /*
     * The rendering entry point
     */
    render() {
        if (!this.state.isInitialised) {
            return this._renderInitialScreen();
        }
        else {
            return this._renderMain();
        }
    }
    /*
     * Page startup logic
     */
    async componentDidMount() {
        await this._initialiseApp();
    }
    /*
     * Application startup code
     */
    async _initialiseApp() {
        // Reset state
        this.setState({
            isInitialised: false,
            isInLoggedOutView: false,
            isMainViewLoaded: false,
            isMobileSize: this._isMobileSize(),
            error: null,
        });
        try {
            // First download configuration from the browser's web domain
            const loader = new _configuration_configurationLoader__WEBPACK_IMPORTED_MODULE_3__.ConfigurationLoader();
            this._configuration = await loader.download();
            // Create the authenticator and receive any login responses on the main window
            this._authenticator = this._createAuthenticator();
            await this._authenticator.initialise();
            await this._authenticator.handleLoginResponse();
            // Create the API client
            this._apiClient = new _api_client_apiClient__WEBPACK_IMPORTED_MODULE_2__.ApiClient(this._configuration.app.apiBaseUrl, this._authenticator);
            // Subscribe to window events
            window.onhashchange = this._onHashChange;
            window.onresize = this._onResize;
            // Update state
            this.setState({ isInitialised: true });
        }
        catch (e) {
            this.setState({ error: _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_6__.ErrorHandler.getFromException(e) });
        }
    }
    /*
     * Render basic details before the app has processed its configuration
     */
    _renderInitialScreen() {
        const titleProps = {
            userInfo: null,
        };
        const headerButtonProps = {
            sessionButtonsEnabled: this.state.isMainViewLoaded && !this.state.isInLoggedOutView,
            handleHomeClick: this._onHome,
            handleReloadDataClick: this._onReloadData,
            handleExpireAccessTokenClick: this._onExpireAccessToken,
            handleExpireRefreshTokenClick: this._onExpireRefreshToken,
            handleLogoutClick: this._onLogout,
        };
        const errorProps = {
            hyperlinkMessage: 'Startup Problem Encountered',
            dialogTitle: 'Startup Error',
            error: this.state.error,
            centred: true,
        };
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_views_errors_errorBoundary__WEBPACK_IMPORTED_MODULE_11__.ErrorBoundary, null,
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_views_headings_titleView__WEBPACK_IMPORTED_MODULE_15__.TitleView, Object.assign({}, titleProps)),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_views_headings_headerButtonsView__WEBPACK_IMPORTED_MODULE_13__.HeaderButtonsView, Object.assign({}, headerButtonProps)),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_views_errors_errorSummaryView__WEBPACK_IMPORTED_MODULE_12__.ErrorSummaryView, Object.assign({}, errorProps))));
    }
    /*
     * Attempt to render the entire layout, which will trigger calls to Web APIs
     */
    _renderMain() {
        const titleProps = {
            userInfo: {
                apiClient: this._apiClient,
                events: this._apiViewEvents,
                shouldLoad: !this.state.isInLoggedOutView,
            },
        };
        const headerButtonProps = {
            sessionButtonsEnabled: this.state.isMainViewLoaded && !this.state.isInLoggedOutView,
            handleHomeClick: this._onHome,
            handleExpireAccessTokenClick: this._onExpireAccessToken,
            handleExpireRefreshTokenClick: this._onExpireRefreshToken,
            handleReloadDataClick: this._onReloadData,
            handleLogoutClick: this._onLogout,
        };
        const errorProps = {
            hyperlinkMessage: 'Problem Encountered',
            dialogTitle: 'Application Error',
            error: this.state.error,
            centred: true,
        };
        const sessionProps = {
            apiClient: this._apiClient,
            isVisible: !this.state.isInLoggedOutView,
        };
        const mainViewProps = {
            onLoading: this._onMainViewLoading,
            apiClient: this._apiClient,
            events: this._apiViewEvents,
            isMobileSize: this.state.isMobileSize,
        };
        const loginRequiredProps = {
            onLoading: this._onLoggedOutViewLoading,
        };
        // Callbacks to prevent multi line JSX warnings
        const renderCompaniesView = () => react__WEBPACK_IMPORTED_MODULE_0__.createElement(_views_companies_companiesContainer__WEBPACK_IMPORTED_MODULE_10__.CompaniesContainer, Object.assign({}, mainViewProps));
        const renderTransactionsView = (props) => react__WEBPACK_IMPORTED_MODULE_0__.createElement(_views_transactions_transactionsContainer__WEBPACK_IMPORTED_MODULE_17__.TransactionsContainer, Object.assign({}, props, mainViewProps));
        const renderLoginRequiredView = () => react__WEBPACK_IMPORTED_MODULE_0__.createElement(_views_loginRequired_loginRequiredView__WEBPACK_IMPORTED_MODULE_16__.LoginRequiredView, Object.assign({}, loginRequiredProps));
        // Render the tree view
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_views_errors_errorBoundary__WEBPACK_IMPORTED_MODULE_11__.ErrorBoundary, null,
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_views_headings_titleView__WEBPACK_IMPORTED_MODULE_15__.TitleView, Object.assign({}, titleProps)),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_views_headings_headerButtonsView__WEBPACK_IMPORTED_MODULE_13__.HeaderButtonsView, Object.assign({}, headerButtonProps)),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_views_errors_errorSummaryView__WEBPACK_IMPORTED_MODULE_12__.ErrorSummaryView, Object.assign({}, errorProps)),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_views_headings_sessionView__WEBPACK_IMPORTED_MODULE_14__.SessionView, Object.assign({}, sessionProps)),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_21__.HashRouter, { hashType: 'noslash' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Switch, null,
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Route, { exact: true, path: '/', render: renderCompaniesView }),
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Route, { exact: true, path: '/company=:id', render: renderTransactionsView }),
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Route, { exact: true, path: '/loggedout', render: renderLoginRequiredView }),
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_22__.Route, { path: '*', render: renderCompaniesView })))));
    }
    /*
     * Create the authenticator object from our configuration, and supply callbacks
     */
    _createAuthenticator() {
        return _plumbing_oauth_authenticatorFactory__WEBPACK_IMPORTED_MODULE_9__.AuthenticatorFactory.createAuthenticator(this._configuration.oauth, this._configuration.app.webBaseUrl, this._onMobileWebViewLogin, this._onMoveToLoggedOutView);
    }
    /*
     * Trigger a login redirect when all views have finished calling the API and there has been a login_required error
     */
    async _onLoginRequired() {
        try {
            // Do the login redirect via the authenticator class
            this.setState({ error: null });
            await this._authenticator.login();
            // When running in a mobile web view we may still be in the login required view, in which case move home
            if (this.state.isInLoggedOutView) {
                location.hash = '#';
            }
        }
        catch (e) {
            // Treat cancelled logins as a non error, when running in a mobile web view
            const error = _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_6__.ErrorHandler.getFromException(e);
            if (error.errorCode === _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_5__.ErrorCodes.redirectCancelled) {
                location.hash = '#loggedout';
                return;
            }
            this.setState({ error: _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_6__.ErrorHandler.getFromException(e) });
        }
    }
    /*
     * Called after login completes successfully when running in a mobile web view
     */
    _onMobileWebViewLogin() {
        this._onReloadData(false);
    }
    /*
     * Update state when the companies or transactions view loads
     */
    _onMainViewLoading() {
        this.setState({ isInLoggedOutView: false });
    }
    /*
     * Update state when the logged out view loads
     */
    _onLoggedOutViewLoading() {
        this.setState({ isInLoggedOutView: true });
    }
    /*
     * Update session buttons when the main view starts and ends loading
     */
    _onMainViewLoadStateChanged(loaded) {
        this.setState({ isMainViewLoaded: loaded });
    }
    /*
     * Handle updates to log levels when the URL log setting is changed
     */
    _onHashChange() {
        this._authenticator.updateLogLevelIfRequired();
    }
    /*
     * Ask all views to get updated data from the API
     */
    _onReloadData(causeError) {
        this._apiViewEvents.clearState();
        _plumbing_events_eventEmitter__WEBPACK_IMPORTED_MODULE_7__.EventEmitter.dispatch(_plumbing_events_eventNames__WEBPACK_IMPORTED_MODULE_8__.EventNames.ON_RELOAD_MAIN, causeError);
        _plumbing_events_eventEmitter__WEBPACK_IMPORTED_MODULE_7__.EventEmitter.dispatch(_plumbing_events_eventNames__WEBPACK_IMPORTED_MODULE_8__.EventNames.ON_RELOAD_USERINFO, causeError);
    }
    /*
     * Return home and force a reload of data
     */
    async _onHome() {
        // If there is a startup error then reinitialise the app
        if (!this.state.isInitialised) {
            await this._initialiseApp();
        }
        if (this.state.isInitialised) {
            if (_views_utilities_routeHelper__WEBPACK_IMPORTED_MODULE_20__.RouteHelper.isInHomeView()) {
                // Force a reload of the main view if we are already in the home view
                _plumbing_events_eventEmitter__WEBPACK_IMPORTED_MODULE_7__.EventEmitter.dispatch(_plumbing_events_eventNames__WEBPACK_IMPORTED_MODULE_8__.EventNames.ON_RELOAD_MAIN, false);
            }
            else {
                // Otherwise navigate to the home view
                location.hash = '#';
            }
        }
    }
    /*
     * Trigger a logout redirect
     */
    async _onLogout() {
        try {
            // Update state
            this.setState({ isMainViewLoaded: false });
            // Start the logout redirect, which will return to the app in the login required page
            await this._authenticator.logout();
        }
        catch (e) {
            // Treat cancelled logouts as a non error, when running in a mobile web view
            const error = _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_6__.ErrorHandler.getFromException(e);
            if (error.errorCode !== _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_5__.ErrorCodes.redirectCancelled) {
                // Otherwise output logout error details only to the console
                _plumbing_errors_errorConsoleReporter__WEBPACK_IMPORTED_MODULE_4__.ErrorConsoleReporter.output(error);
            }
        }
        finally {
            // Ensure that we are in the logged out view in all cases
            this._onMoveToLoggedOutView();
        }
    }
    /*
     * Called when we move to the logged out view manually, such as when there is a logout error
     * This also occurs when there is a logout on another tab and we receive a check session iframe notification
     */
    _onMoveToLoggedOutView() {
        location.hash = '#loggedout';
    }
    /*
     * For test purposes this makes the access token act expired
     */
    async _onExpireAccessToken() {
        await this._authenticator.expireAccessToken();
    }
    /*
     * For test purposes this makes the refresh token act expired
     */
    async _onExpireRefreshToken() {
        try {
            // Where applicable, make the refresh token act expired
            this.setState({ error: null });
            await this._authenticator.expireRefreshToken();
        }
        catch (e) {
            // Report errors
            this.setState({ error: _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_6__.ErrorHandler.getFromException(e) });
        }
    }
    /*
     * Handle switching between mobile and main view sizes
     */
    _onResize() {
        if (!this.state.isMobileSize && this._isMobileSize()) {
            // Handle changing from a large size to mobile size
            this.setState({ isMobileSize: true });
        }
        else if (this.state.isMobileSize && !this._isMobileSize()) {
            // Handle changing from a mobile size to large size
            this.setState({ isMobileSize: false });
        }
    }
    /*
     * Indicate whether the current size is that of a mobile device
     */
    _isMobileSize() {
        return window.innerWidth < 768;
    }
    /*
     * Plumbing to ensure that the this parameter is available in callback functions
     */
    _setupCallbacks() {
        this._onMainViewLoading = this._onMainViewLoading.bind(this);
        this._onLoggedOutViewLoading = this._onLoggedOutViewLoading.bind(this);
        this._onMainViewLoadStateChanged = this._onMainViewLoadStateChanged.bind(this);
        this._onHashChange = this._onHashChange.bind(this);
        this._onHome = this._onHome.bind(this);
        this._onLoginRequired = this._onLoginRequired.bind(this);
        this._onReloadData = this._onReloadData.bind(this);
        this._onMobileWebViewLogin = this._onMobileWebViewLogin.bind(this);
        this._onLogout = this._onLogout.bind(this);
        this._onMoveToLoggedOutView = this._onMoveToLoggedOutView.bind(this);
        this._onExpireAccessToken = this._onExpireAccessToken.bind(this);
        this._onExpireRefreshToken = this._onExpireRefreshToken.bind(this);
        this._onResize = this._onResize.bind(this);
    }
}


/***/ }),

/***/ "./app/iframeApp.ts":
/*!**************************!*\
  !*** ./app/iframeApp.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IFrameApp": () => (/* binding */ IFrameApp)
/* harmony export */ });
/* harmony import */ var _configuration_configurationLoader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../configuration/configurationLoader */ "./configuration/configurationLoader.ts");
/* harmony import */ var _plumbing_errors_errorConsoleReporter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../plumbing/errors/errorConsoleReporter */ "./plumbing/errors/errorConsoleReporter.ts");
/* harmony import */ var _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../plumbing/errors/errorCodes */ "./plumbing/errors/errorCodes.ts");
/* harmony import */ var _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../plumbing/errors/errorHandler */ "./plumbing/errors/errorHandler.ts");
/* harmony import */ var _plumbing_oauth_web_utilities_tokenRenewalResponseHandler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../plumbing/oauth/web/utilities/tokenRenewalResponseHandler */ "./plumbing/oauth/web/utilities/tokenRenewalResponseHandler.ts");





/*
 * A mini application for the hidden iframe that does silent token renewal
 */
class IFrameApp {
    async execute() {
        try {
            // Download configuration
            const configuration = await new _configuration_configurationLoader__WEBPACK_IMPORTED_MODULE_0__.ConfigurationLoader().download();
            // Handle token renewal responses on an iframe
            const handler = new _plumbing_oauth_web_utilities_tokenRenewalResponseHandler__WEBPACK_IMPORTED_MODULE_4__.TokenRenewalResponseHandler(configuration.oauth);
            await handler.handleSilentTokenRenewalResponse();
        }
        catch (e) {
            // In the event of errors, avoid impacting end users and output the error to the console
            const uiError = _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_3__.ErrorHandler.getFromTokenError(e, _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_2__.ErrorCodes.tokenRenewalError);
            _plumbing_errors_errorConsoleReporter__WEBPACK_IMPORTED_MODULE_1__.ErrorConsoleReporter.output(uiError);
        }
    }
}


/***/ }),

/***/ "./configuration/configurationLoader.ts":
/*!**********************************************!*\
  !*** ./configuration/configurationLoader.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConfigurationLoader": () => (/* binding */ ConfigurationLoader)
/* harmony export */ });
/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ "../node_modules/axios/index.js");
/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../plumbing/errors/errorHandler */ "./plumbing/errors/errorHandler.ts");
/* harmony import */ var _plumbing_utilities_axiosUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../plumbing/utilities/axiosUtils */ "./plumbing/utilities/axiosUtils.ts");



/*
 * A class to download configuration from the server
 */
class ConfigurationLoader {
    /*
     * Download JSON data from the app config file
     */
    async download() {
        const fileName = 'spa.config.json';
        try {
            // Make the remote call
            const response = await axios__WEBPACK_IMPORTED_MODULE_0___default().get(fileName);
            _plumbing_utilities_axiosUtils__WEBPACK_IMPORTED_MODULE_2__.AxiosUtils.checkJson(response.data);
            return response.data;
        }
        catch (xhr) {
            // Capture error details
            throw _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_1__.ErrorHandler.getFromHttpError(xhr, fileName, 'Web Server');
        }
    }
}


/***/ }),

/***/ "./index.tsx":
/*!*******************!*\
  !*** ./index.tsx ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-dom */ "../node_modules/react-dom/index.js");
/* harmony import */ var _app_app__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./app/app */ "./app/app.tsx");
/* harmony import */ var _app_iframeApp__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/iframeApp */ "./app/iframeApp.ts");




/*
 * The application entry point
 */
if (window.top === window.self) {
    // Run the main ReactJS app
    (0,react_dom__WEBPACK_IMPORTED_MODULE_1__.render)(react__WEBPACK_IMPORTED_MODULE_0__.createElement(_app_app__WEBPACK_IMPORTED_MODULE_2__.App, null), document.getElementById('root'));
}
else {
    // If our SPA is running on an iframe, handle token renewal responses
    const app = new _app_iframeApp__WEBPACK_IMPORTED_MODULE_3__.IFrameApp();
    app.execute();
}


/***/ }),

/***/ "./plumbing/errors/errorCodes.ts":
/*!***************************************!*\
  !*** ./plumbing/errors/errorCodes.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ErrorCodes": () => (/* binding */ ErrorCodes)
/* harmony export */ });
/*
 * Error codes that the UI can program against
 */
class ErrorCodes {
}
// Used to indicate that the API cannot be called until the user logs in
// Also returned by OAuth error responses when token renewal via prompt=none fails
ErrorCodes.loginRequired = 'login_required';
// A technical error starting a login request, such as contacting the metadata endpoint
ErrorCodes.loginRequestFailed = 'login_request_failed';
// A technical error processing the login response containing the authorization code
ErrorCodes.loginResponseFailed = 'login_response_failed';
// A technical problem during background token renewal
ErrorCodes.tokenRenewalError = 'token_renewal_error';
// The OAuth error when a refresh token expires
ErrorCodes.invalidGrant = 'invalid_grant';
// An error starting a logout request, such as contacting the metadata endpoint
ErrorCodes.logoutRequestFailed = 'logout_request_failed';
// An error due to no logout standards support
ErrorCodes.logoutUnsupported = 'logout_unsupported';
// An error logging out due to a missing id token on the current tab
ErrorCodes.missingIdToken = 'missing_id_token';
// Used when running in a mobile web view and the AppAuth redirect is cancelled
ErrorCodes.redirectCancelled = 'redirect_cancelled';
// A general exception in the UI
ErrorCodes.generalUIError = 'ui_error';
// An error making an Ajax call
ErrorCodes.networkError = 'network_error';
// An error receiving data as JSON
ErrorCodes.jsonDataError = 'json_data_error';
// An error response fropm the API
ErrorCodes.responseError = 'http_response_error';
// An error rendering a ReactJs view
ErrorCodes.renderError = 'react_render_error';
// Returned by the API when the user edits the browser URL and ties to access an unauthorised company
ErrorCodes.companyNotFound = 'company_not_found';
// Returned by the API when the user edits the browser URL and supplies a non numeric company id
ErrorCodes.invalidCompanyId = 'invalid_company_id';


/***/ }),

/***/ "./plumbing/errors/errorConsoleReporter.ts":
/*!*************************************************!*\
  !*** ./plumbing/errors/errorConsoleReporter.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ErrorConsoleReporter": () => (/* binding */ ErrorConsoleReporter)
/* harmony export */ });
/* harmony import */ var _errorFormatter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./errorFormatter */ "./plumbing/errors/errorFormatter.ts");

/*
 * A utility class for errors we don't want to bother the user about
 */
class ErrorConsoleReporter {
    /*
     * Output error fields as name / value pairs
     */
    static output(error) {
        const lines = new _errorFormatter__WEBPACK_IMPORTED_MODULE_0__.ErrorFormatter().getErrorLines(error);
        lines.forEach((l) => {
            console.log(`${l.label}: ${l.value}`);
        });
    }
}


/***/ }),

/***/ "./plumbing/errors/errorFormatter.ts":
/*!*******************************************!*\
  !*** ./plumbing/errors/errorFormatter.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ErrorFormatter": () => (/* binding */ ErrorFormatter)
/* harmony export */ });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "../node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);

/*
 * A class to manage error formatting
 */
class ErrorFormatter {
    constructor() {
        this._count = 0;
    }
    /*
     * Get errors ready for display
     */
    getErrorLines(error) {
        const lines = [];
        /* FIELDS FOR THE END USER */
        // Keep the user informed and suggest an action
        lines.push(this._createErrorLine('User Action', error.userAction, 'highlightcolor'));
        // Give the user summary level info, such as 'Network error'
        if (error.message.length > 0) {
            lines.push(this._createErrorLine('Info', error.message));
        }
        /* FIELDS FOR TECHNICAL SUPPORT STAFF */
        // Show the time of the error
        if (error.utcTime.length > 0) {
            const displayTime = moment__WEBPACK_IMPORTED_MODULE_0___default()(error.utcTime).format('DD MMM YYYY HH:mm:ss');
            lines.push(this._createErrorLine('UTC Time', displayTime));
        }
        // Indicate the area of the system, such as which component failed
        if (error.area.length > 0) {
            lines.push(this._createErrorLine('Area', error.area));
        }
        // Indicate the type of error
        if (error.errorCode.length > 0) {
            lines.push(this._createErrorLine('Error Code', error.errorCode));
        }
        // Show the AppAuth error code if applicable, in mobile web scenarios
        if (error.appAuthCode.length > 0) {
            lines.push(this._createErrorLine('AppAuth Code', error.appAuthCode.toString()));
        }
        // Link to API logs if applicable
        if (error.instanceId > 0) {
            lines.push(this._createErrorLine('Instance Id', error.instanceId.toString(), 'errorcolor'));
        }
        // Show the HTTP status if applicable
        if (error.statusCode > 0) {
            lines.push(this._createErrorLine('Status Code', error.statusCode.toString()));
        }
        /* FIELDS FOR DEVELOPERS */
        // Show details for some types of error
        if (error.details.length > 0) {
            lines.push(this._createErrorLine('Details', error.details));
        }
        // Show the URL that failed if applicable
        if (error.url.length > 0) {
            lines.push(this._createErrorLine('URL', error.url));
        }
        return lines;
    }
    /*
     * Return the stack separately, since it is rendered in smaller text
     */
    getErrorStack(error) {
        // In debug builds render the stack trace as a long string
        // We can then look up results at https://sourcemaps.info
        if (true) {
            if (error.stack) {
                return this._createErrorLine('Stack', error.stack);
            }
        }
        return null;
    }
    /*
     * Return an error line as an object
     */
    _createErrorLine(label, value, valueStyle = 'valuecolor') {
        return {
            id: ++this._count,
            label,
            value,
            valueStyle,
        };
    }
}


/***/ }),

/***/ "./plumbing/errors/errorHandler.ts":
/*!*****************************************!*\
  !*** ./plumbing/errors/errorHandler.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ErrorHandler": () => (/* binding */ ErrorHandler)
/* harmony export */ });
/* harmony import */ var _errorCodes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./errorCodes */ "./plumbing/errors/errorCodes.ts");
/* harmony import */ var _uiError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./uiError */ "./plumbing/errors/uiError.ts");


/*
 * A class to handle error processing
 */
class ErrorHandler {
    /*
     * Return an error based on the exception type or properties
     */
    static getFromException(exception) {
        // Already handled errors
        if (exception instanceof _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError) {
            return exception;
        }
        // Create the error
        const error = new _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError('Web UI', _errorCodes__WEBPACK_IMPORTED_MODULE_0__.ErrorCodes.generalUIError, 'A technical problem was encountered in the UI', exception.stack);
        // Set technical details from the received exception
        error.details = ErrorHandler._getExceptionMessage(exception);
        return error;
    }
    /*
     * A login required error is thrown to short circuit execution when the UI cannot get an access token
     */
    static getFromLoginRequired() {
        return new _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError('Login', _errorCodes__WEBPACK_IMPORTED_MODULE_0__.ErrorCodes.loginRequired, 'No access token is available and a login is required');
    }
    /*
     * Handle errors signing in
     */
    static getFromLoginOperation(exception, errorCode) {
        // Already handled errors
        if (exception instanceof _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError) {
            return exception;
        }
        // Create the error
        const error = new _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError('Login', errorCode, 'A technical problem occurred during login processing', exception.stack);
        // Set technical details from the received exception
        error.details = ErrorHandler._getOAuthExceptionMessage(exception);
        return error;
    }
    /*
     * Handle errors interacting with the token endpoint
     */
    static getFromTokenError(exception, errorCode) {
        // Already handled errors
        if (exception instanceof _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError) {
            return exception;
        }
        // Create the error
        const error = new _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError('Token', errorCode, 'A technical problem occurred during token processing', exception.stack);
        // Set technical details from the received exception
        error.details = ErrorHandler._getOAuthExceptionMessage(exception);
        return error;
    }
    /*
     * Handle sign out request errors
     */
    static getFromLogoutOperation(exception, errorCode) {
        // Already handled errors
        if (exception instanceof _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError) {
            return exception;
        }
        // Create the error
        const error = new _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError('Logout', errorCode, 'A technical problem occurred during logout processing', exception.stack);
        // Set technical details from the received exception
        error.details = ErrorHandler._getOAuthExceptionMessage(exception);
        return error;
    }
    /*
     * Indicate if we don't know how to logout
     */
    static getFromLogoutUnsupported() {
        return new _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError('Logout', _errorCodes__WEBPACK_IMPORTED_MODULE_0__.ErrorCodes.logoutUnsupported, 'Logout is not supported by this provider, due to a missing end session endpoint');
    }
    /*
     * Indicate if the id token is missing during a logout attempt
     */
    static getFromMissingIdToken() {
        return new _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError('Logout', _errorCodes__WEBPACK_IMPORTED_MODULE_0__.ErrorCodes.missingIdToken, 'Unable to logout because no id token exists for this browser tab');
    }
    /*
     * Return an object for Ajax errors
     */
    static getFromJsonParseError() {
        return new _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError('Data', _errorCodes__WEBPACK_IMPORTED_MODULE_0__.ErrorCodes.jsonDataError, 'HTTP response data was not valid JSON and could not be parsed');
    }
    /*
     * Return an object for Ajax errors
     */
    static getFromHttpError(exception, url, source) {
        // Already handled errors
        if (exception instanceof _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError) {
            return exception;
        }
        // Calculate the status code
        let statusCode = 0;
        if (exception.response && exception.response.status) {
            statusCode = exception.response.status;
        }
        let error = null;
        if (statusCode === 0) {
            // This status is generally a CORS or availability problem
            error = new _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError('Network', _errorCodes__WEBPACK_IMPORTED_MODULE_0__.ErrorCodes.networkError, `A network problem occurred when the UI called the ${source}`, exception.stack);
            error.details = this._getExceptionMessage(exception);
        }
        else if (statusCode >= 200 && statusCode <= 299) {
            // This status is generally a JSON parsing error
            error = new _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError('JSON', _errorCodes__WEBPACK_IMPORTED_MODULE_0__.ErrorCodes.jsonDataError, `'A technical problem occurred parsing data from the ${source}`, exception.stack);
            error.details = this._getExceptionMessage(exception);
        }
        else {
            // Create an error indicating a data problem
            error = new _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError(source, _errorCodes__WEBPACK_IMPORTED_MODULE_0__.ErrorCodes.responseError, `An error response was returned from the ${source}`, exception.stack);
            error.details = this._getExceptionMessage(exception);
            // Override the default with a server response when received and CORS allows us to read it
            if (exception.response && exception.response.data && typeof exception.response.data === 'object') {
                ErrorHandler._updateFromApiErrorResponse(error, exception.response.data);
            }
        }
        error.statusCode = statusCode;
        error.url = url;
        return error;
    }
    /*
     * Return an error due to rendering the view
     */
    static getFromRenderError(exception, componentStack) {
        // Already handled errors
        if (exception instanceof _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError) {
            return exception;
        }
        // Create the error
        const error = new _uiError__WEBPACK_IMPORTED_MODULE_1__.UIError('Web UI', _errorCodes__WEBPACK_IMPORTED_MODULE_0__.ErrorCodes.renderError, 'A technical problem was encountered rendering the UI', exception.stack);
        // Set technical details from the received exception
        error.details = ErrorHandler._getExceptionMessage(exception);
        if (componentStack) {
            error.details += ` : ${componentStack}`;
        }
        return error;
    }
    /*
     * Try to update the default API error with response details
     */
    static _updateFromApiErrorResponse(error, apiError) {
        // Attempt to read the API error response
        if (apiError) {
            // Set the code and message, returned for both 4xx and 5xx errors
            if (apiError.code && apiError.message) {
                error.errorCode = apiError.code;
                error.details = apiError.message;
            }
            // Set extra details returned for 5xx errors
            if (apiError.area && apiError.id && apiError.utcTime) {
                error.setApiErrorDetails(apiError.area, apiError.id, apiError.utcTime);
            }
        }
    }
    /*
     * Get the message from an OAuth exception
     */
    static _getOAuthExceptionMessage(exception) {
        let oauthError = '';
        if (exception.error) {
            oauthError = exception.error;
            if (exception.error_description) {
                oauthError += ` : ${(exception.error_description.replace(/\+/g, ' '))}`;
            }
        }
        if (oauthError) {
            return oauthError;
        }
        else {
            return ErrorHandler._getExceptionMessage(exception);
        }
    }
    /*
     * Get the message from an exception and avoid returning [object Object]
     */
    static _getExceptionMessage(exception) {
        if (exception.message) {
            return exception.message;
        }
        const details = exception.toString();
        if (details !== {}.toString()) {
            return details;
        }
        return '';
    }
}


/***/ }),

/***/ "./plumbing/errors/uiError.ts":
/*!************************************!*\
  !*** ./plumbing/errors/uiError.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "UIError": () => (/* binding */ UIError)
/* harmony export */ });
/*
 * An error entity containing translated error data for any kind of error
 */
class UIError extends Error {
    /*
     * All types of error supply at least these fields
     */
    constructor(area, errorCode, userMessage, stack) {
        super(userMessage);
        this._area = area;
        this._errorCode = errorCode;
        this._userAction = 'Please retry the operation';
        this._utcTime = new Date().toISOString();
        this._statusCode = 0;
        this._instanceId = 0;
        this._appAuthCode = '';
        this._details = '';
        this._url = '';
        // Ensure that instanceof works
        Object.setPrototypeOf(this, new.target.prototype);
        // Store the stack of the original exception if provided
        if (stack) {
            this.stack = stack;
        }
    }
    get area() {
        return this._area;
    }
    get errorCode() {
        return this._errorCode;
    }
    set errorCode(value) {
        this._errorCode = value;
    }
    get userAction() {
        return this._userAction;
    }
    set userAction(value) {
        this._userAction = value;
    }
    get utcTime() {
        return this._utcTime;
    }
    get statusCode() {
        return this._statusCode;
    }
    set statusCode(value) {
        this._statusCode = value;
    }
    get instanceId() {
        return this._instanceId;
    }
    get appAuthCode() {
        return this._appAuthCode;
    }
    set appAuthCode(value) {
        this._appAuthCode = value;
    }
    get details() {
        return this._details;
    }
    set details(value) {
        this._details = value;
    }
    get url() {
        return this._url;
    }
    set url(value) {
        this._url = value;
    }
    /*
     * Override details when an API 500 error is handled
     */
    setApiErrorDetails(area, id, utcTime) {
        this._area = area;
        this._instanceId = id;
        this._utcTime = utcTime;
    }
}


/***/ }),

/***/ "./plumbing/events/eventEmitter.ts":
/*!*****************************************!*\
  !*** ./plumbing/events/eventEmitter.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "EventEmitter": () => (/* binding */ EventEmitter)
/* harmony export */ });
/*
 * A simple event emitter class
 */
class EventEmitter {
    /*
     * Subscribe to a named event
     */
    static subscribe(name, callback) {
        let item = EventEmitter._events.find((e) => e.name === name);
        if (!item) {
            item = {
                name,
                callbacks: [],
            };
            EventEmitter._events.push(item);
        }
        item.callbacks.push(callback);
    }
    /*
     * Unsubscribe and remove storage
     */
    static unsubscribe(name, callback) {
        const item = EventEmitter._events.find((e) => e.name === name);
        if (item) {
            item.callbacks = item.callbacks.filter((c) => c !== callback);
            if (item.callbacks.length === 0) {
                EventEmitter._events = EventEmitter._events.filter((e) => e.name !== name);
            }
        }
    }
    /*
     * Dispatch named event messages
     */
    static dispatch(name, data) {
        const item = EventEmitter._events.find((e) => e.name === name);
        if (item) {
            item.callbacks.forEach((callback) => callback(data));
        }
    }
}
EventEmitter._events = [];


/***/ }),

/***/ "./plumbing/events/eventNames.ts":
/*!***************************************!*\
  !*** ./plumbing/events/eventNames.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "EventNames": () => (/* binding */ EventNames)
/* harmony export */ });
/*
 * Constants for event names
 */
class EventNames {
}
// An event to reload the main view
EventNames.ON_RELOAD_MAIN = 'reload_main';
// An event to reload the user info view
EventNames.ON_RELOAD_USERINFO = 'reload_userinfo';


/***/ }),

/***/ "./plumbing/oauth/authenticatorFactory.ts":
/*!************************************************!*\
  !*** ./plumbing/oauth/authenticatorFactory.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AuthenticatorFactory": () => (/* binding */ AuthenticatorFactory)
/* harmony export */ });
/* harmony import */ var oidc_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! oidc-client */ "../node_modules/oidc-client/lib/oidc-client.min.js");
/* harmony import */ var oidc_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(oidc_client__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _utilities_urlHelper__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utilities/urlHelper */ "./plumbing/utilities/urlHelper.ts");
/* harmony import */ var _utilities_userAgentHelper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utilities/userAgentHelper */ "./plumbing/utilities/userAgentHelper.ts");
/* harmony import */ var _mobile_mobileAuthenticator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./mobile/mobileAuthenticator */ "./plumbing/oauth/mobile/mobileAuthenticator.ts");
/* harmony import */ var _web_extended_extendedWebAuthenticator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./web/extended/extendedWebAuthenticator */ "./plumbing/oauth/web/extended/extendedWebAuthenticator.ts");
/* harmony import */ var _web_webAuthenticator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./web/webAuthenticator */ "./plumbing/oauth/web/webAuthenticator.ts");






/*
 * Create the authenticator based on configuration
 */
class AuthenticatorFactory {
    /*
     * Return different authenticator strategies depending on the configuration and runtime conditions
     */
    static createAuthenticator(configuration, webBaseUrl, onLoggedIn, onLoggedOut) {
        if (_utilities_userAgentHelper__WEBPACK_IMPORTED_MODULE_2__.UserAgentHelper.isAndroidWebView() || _utilities_userAgentHelper__WEBPACK_IMPORTED_MODULE_2__.UserAgentHelper.isIosWebView()) {
            // When running in a web view we create an authenticator that calls back the mobile app
            return new _mobile_mobileAuthenticator__WEBPACK_IMPORTED_MODULE_3__.MobileAuthenticator(onLoggedIn);
        }
        else {
            const options = AuthenticatorFactory._createWebAuthenticatorOptions(configuration, webBaseUrl, onLoggedOut);
            if (!configuration.reverseProxyPath) {
                // Use standard SPA security by default
                return new _web_webAuthenticator__WEBPACK_IMPORTED_MODULE_5__.WebAuthenticator(options);
            }
            else {
                // Use an extended authenticator when proxying requests containing refresh tokens
                return new _web_extended_extendedWebAuthenticator__WEBPACK_IMPORTED_MODULE_4__.ExtendedWebAuthenticator(options);
            }
        }
    }
    /*
     * Create the base settings for a web authenticator
     */
    static _createWebAuthenticatorOptions(configuration, webBaseUrl, onLoggedOut) {
        return {
            configuration,
            webBaseUrl,
            onLoggedOut,
            settings: {
                // The Open Id Connect base URL
                authority: configuration.authority,
                // Core OAuth settings for our app
                client_id: configuration.clientId,
                redirect_uri: _utilities_urlHelper__WEBPACK_IMPORTED_MODULE_1__.UrlHelper.append(webBaseUrl, configuration.redirectUri),
                scope: configuration.scope,
                // Use the Authorization Code Flow (PKCE)
                response_type: 'code',
                // By default, store tokens only in memory
                userStore: new oidc_client__WEBPACK_IMPORTED_MODULE_0__.WebStorageStateStore({ store: new oidc_client__WEBPACK_IMPORTED_MODULE_0__.InMemoryWebStorage() }),
                // Renew on the app's main URL and do so explicitly rather than via a background timer
                silent_redirect_uri: _utilities_urlHelper__WEBPACK_IMPORTED_MODULE_1__.UrlHelper.append(webBaseUrl, configuration.redirectUri),
                automaticSilentRenew: false,
                // Our Web UI gets user info from its API
                loadUserInfo: false,
                // Indicate the logout return path and listen for logout events from other browser tabs
                post_logout_redirect_uri: _utilities_urlHelper__WEBPACK_IMPORTED_MODULE_1__.UrlHelper.append(webBaseUrl, configuration.postLogoutRedirectUri),
                monitorSession: true,
            },
        };
    }
}


/***/ }),

/***/ "./plumbing/oauth/mobile/mobileAuthenticator.ts":
/*!******************************************************!*\
  !*** ./plumbing/oauth/mobile/mobileAuthenticator.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MobileAuthenticator": () => (/* binding */ MobileAuthenticator)
/* harmony export */ });
/* harmony import */ var guid_typescript__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! guid-typescript */ "../node_modules/guid-typescript/dist/guid.js");
/* harmony import */ var _mobileMethodCaller__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mobileMethodCaller */ "./plumbing/oauth/mobile/mobileMethodCaller.ts");


/*
 * An implementation that calls back the hosting mobile app
 */
class MobileAuthenticator {
    constructor(_onLoggedInAction) {
        this._methodCaller = new _mobileMethodCaller__WEBPACK_IMPORTED_MODULE_1__.MobileMethodCaller();
        this._onLoggedInAction = _onLoggedInAction;
    }
    /*
     * This is a no op in the mobile case
     */
    async initialise() {
    }
    /*
     * Ask the mobile app for the current access token
     */
    async getAccessToken() {
        return this._methodCaller.callAsync('getAccessToken', guid_typescript__WEBPACK_IMPORTED_MODULE_0__.Guid.create().toString());
    }
    /*
     * Ask the mobile app to use its refresh token to get a new access token
     */
    async refreshAccessToken() {
        return this._methodCaller.callAsync('refreshAccessToken', guid_typescript__WEBPACK_IMPORTED_MODULE_0__.Guid.create().toString());
    }
    /*
     * Do the login operation, which does not involve redirecting the whole page
     */
    async login() {
        // Do the login work in the mobile app
        await this._methodCaller.callAsync('login');
        // Run other post login actions
        this._onLoggedInAction();
    }
    /*
     * The method to handle a login response on page load is is a no op when running in a web view
     */
    async handleLoginResponse() {
    }
    /*
     * Initiate a logout redirect, which does not involve redirecting the whole page
     */
    async logout() {
        await this._methodCaller.callAsync('logout');
    }
    /*
     * For testing, make the access token act like it is expired
     */
    async expireAccessToken() {
        await this._methodCaller.callAsync('expireAccessToken');
    }
    /*
     * For testing, make the refresh token act like it is expired
     */
    async expireRefreshToken() {
        await this._methodCaller.callAsync('expireRefreshToken');
    }
    /*
     * There is no built in logging for the mobile case
     */
    updateLogLevelIfRequired() {
    }
}


/***/ }),

/***/ "./plumbing/oauth/mobile/mobileMethodCaller.ts":
/*!*****************************************************!*\
  !*** ./plumbing/oauth/mobile/mobileMethodCaller.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "MobileMethodCaller": () => (/* binding */ MobileMethodCaller)
/* harmony export */ });
/* harmony import */ var _errors_uiError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../errors/uiError */ "./plumbing/errors/uiError.ts");

/*
 * A utility class to deal with calling mobile methods, async completion and error responses
 */
class MobileMethodCaller {
    constructor() {
        this._isAndroid = navigator.userAgent.toLowerCase().indexOf('android') !== -1;
    }
    /*
     * An interface to call the mobile app and wait for a deferred result
     */
    async callAsync(methodName, guid) {
        return new Promise((resolve, reject) => {
            // Get a callback name for this mobile method call
            const callbackName = this._getCallbackName(methodName, guid);
            const customWindow = window;
            // First define callback behaviour
            const callback = (data, errorJson) => {
                // First remove the callback
                delete customWindow[callbackName];
                if (errorJson) {
                    // Handle errors if required
                    reject(this._parseMobileError(errorJson));
                }
                else {
                    // Otherwise return a success result
                    resolve(data);
                }
            };
            // Call the mobile method to do the work
            customWindow[callbackName] = callback;
            this._callMethod(customWindow, methodName, callbackName);
        });
    }
    /*
     * The callback name includes a GUID for concurrent operations
     */
    _getCallbackName(methodName, guid) {
        if (guid) {
            return `callback_${methodName}_${guid}`;
        }
        else {
            return `callback_${methodName}`;
        }
    }
    /*
     * Handle differences between Android and iOS interop
     */
    _callMethod(customWindow, methodName, callbackName) {
        if (this._isAndroid) {
            // For Android we call a method on a mobile object
            customWindow.mobileBridge[methodName](callbackName);
        }
        else {
            // For iOS we post a message to a message handler custom object
            const request = {
                methodName,
                callbackName,
            };
            customWindow.webkit.messageHandlers.mobileBridge.postMessage(JSON.stringify(request));
        }
    }
    /*
     * Parse JSON from the mobile app to our own UI error object
     */
    _parseMobileError(errorJson) {
        const obj = JSON.parse(errorJson);
        const error = new _errors_uiError__WEBPACK_IMPORTED_MODULE_0__.UIError(obj.area, obj.errorCode, obj.userMessage);
        if (obj.appAuthCode) {
            error.appAuthCode = obj.appAuthCode;
        }
        // These strings are received as base 64 text to deal with characters that need escaping
        if (obj.details) {
            error.details = atob(obj.details);
        }
        if (obj.stack) {
            error.stack = atob(obj.stack);
        }
        return error;
    }
}


/***/ }),

/***/ "./plumbing/oauth/web/extended/extendedUserManager.ts":
/*!************************************************************!*\
  !*** ./plumbing/oauth/web/extended/extendedUserManager.ts ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ExtendedUserManager": () => (/* binding */ ExtendedUserManager)
/* harmony export */ });
/* harmony import */ var oidc_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! oidc-client */ "../node_modules/oidc-client/lib/oidc-client.min.js");
/* harmony import */ var oidc_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(oidc_client__WEBPACK_IMPORTED_MODULE_0__);

/*
 * Extend the OIDC User Manager class to deal with proxying refresh token related requests
 * This keeps long lived credentials out of the browser and also resolves usability problems
 */
class ExtendedUserManager extends oidc_client__WEBPACK_IMPORTED_MODULE_0__.UserManager {
    constructor(settings, onSignInResponse) {
        super(settings);
        this._onSignInResponse = onSignInResponse;
    }
    /*
     * Override the base method to capture a CSRF token from the authorization code grant response
     */
    async processSigninResponse(url, stateStore) {
        const response = await super.processSigninResponse(url, stateStore);
        this._onSignInResponse(response);
        return response;
    }
    /*
     * Override the base method to force a send of refresh token grant messages
     */
    async signinSilent(args) {
        // The stored user needs a refresh token, which is why we set this dummy value
        await this._setStoredRefreshToken('-');
        // The silent renewal is now guaranteed to never be an iframe renewal request
        const user = await super.signinSilent(args);
        // Undo the temporary value set above
        await this._setStoredRefreshToken('');
        // Return the updated user, with new tokens stored in memory
        return user;
    }
    /*
     * Temporarily change the stored refresh token value to get the behaviour we want
     */
    async _setStoredRefreshToken(value) {
        const user = await this.getUser();
        if (user) {
            user.refresh_token = value;
            await this.storeUser(user);
        }
    }
}


/***/ }),

/***/ "./plumbing/oauth/web/extended/extendedWebAuthenticator.ts":
/*!*****************************************************************!*\
  !*** ./plumbing/oauth/web/extended/extendedWebAuthenticator.ts ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ExtendedWebAuthenticator": () => (/* binding */ ExtendedWebAuthenticator)
/* harmony export */ });
/* harmony import */ var oidc_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! oidc-client */ "../node_modules/oidc-client/lib/oidc-client.min.js");
/* harmony import */ var oidc_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(oidc_client__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _webAuthenticator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../webAuthenticator */ "./plumbing/oauth/web/webAuthenticator.ts");
/* harmony import */ var _extendedUserManager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./extendedUserManager */ "./plumbing/oauth/web/extended/extendedUserManager.ts");
/* harmony import */ var _hybridTokenStorage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./hybridTokenStorage */ "./plumbing/oauth/web/extended/hybridTokenStorage.ts");
/* harmony import */ var _webReverseProxyClient__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./webReverseProxyClient */ "./plumbing/oauth/web/extended/webReverseProxyClient.ts");





/*
 * Extends the standard authenticator to handle refresh tokens stored in encrypted HTTP only cookies
 */
class ExtendedWebAuthenticator extends _webAuthenticator__WEBPACK_IMPORTED_MODULE_1__.WebAuthenticator {
    constructor(options) {
        super(options);
        // Use a custom option to store OIDC state, but not tokens, in local storage
        // This is needed to make the library send token refresh grant messages for new browser tabs
        this._options.settings.userStore = new oidc_client__WEBPACK_IMPORTED_MODULE_0__.WebStorageStateStore({ store: new _hybridTokenStorage__WEBPACK_IMPORTED_MODULE_3__.HybridTokenStorage() });
        // Create an object to manage calls vui the web reverse proxy endpoint
        this._webReverseProxyClient = new _webReverseProxyClient__WEBPACK_IMPORTED_MODULE_4__.WebReverseProxyClient(this._options.configuration.clientId, this._options.webBaseUrl, this._options.configuration.reverseProxyPath);
        this._setupDerivedCallbacks();
    }
    /*
     * Override the base class to make the refresh token in the HTTP only cookie act expired
     */
    async expireRefreshToken() {
        await super.expireAccessToken();
        await this._webReverseProxyClient.expireRefreshToken();
    }
    /*
     * Create a custom user manager used to subclass certain OAuth events
     */
    _createUserManager(settings) {
        this._extendedUserManager = new _extendedUserManager__WEBPACK_IMPORTED_MODULE_2__.ExtendedUserManager(settings, this._onSignInResponse);
        return this._extendedUserManager;
    }
    /*
     * Updates needed to proxy refresh tokens in an HTTP only cookie, along with a CSRF field
     */
    async _onInitialise() {
        // Update the metadata's token endpoint field to point to that of the web reverse proxy
        // Note that metadata is stored against the settings object and the MetadataService is not properly overridable
        const settings = this._extendedUserManager.settings;
        await this._extendedUserManager.metadataService.getMetadata();
        settings.metadata.token_endpoint = this._webReverseProxyClient.getTokenEndpoint();
        // Initialise the web reverse proxy, so that it sends a CSRF field later
        this._webReverseProxyClient.initialise();
    }
    /*
     * Handle the response of the authorization code grant message
     */
    _onSignInResponse(response) {
        this._webReverseProxyClient.storeCsrfFieldFromProxy(response);
    }
    /*
     * When a user session ends, ensure that the refresh token cookie is removed
     */
    async _onSessionExpiring() {
        await this._webReverseProxyClient.clearRefreshToken();
    }
    /*
     * Plumbing to ensure that the this parameter is available in async callbacks
     */
    _setupDerivedCallbacks() {
        this._onSignInResponse = this._onSignInResponse.bind(this);
    }
}


/***/ }),

/***/ "./plumbing/oauth/web/extended/hybridTokenStorage.ts":
/*!***********************************************************!*\
  !*** ./plumbing/oauth/web/extended/hybridTokenStorage.ts ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "HybridTokenStorage": () => (/* binding */ HybridTokenStorage)
/* harmony export */ });
/*
 * A hybrid token storage class that saves tokens only in memory in private class members
 * This makes user state available in new browser tabs so that ExtendedUserManager token refresh works
 */
class HybridTokenStorage {
    constructor() {
        this._accessToken = '';
        this._refreshToken = '';
        this._idToken = '';
    }
    /*
     * Customise token storage after login, so that sensitive data is only in memory
     */
    setItem(key, value) {
        // Store the real tokens in memory
        const deserialized = JSON.parse(value);
        this._removeSensitiveDataWhenStoring(deserialized);
        // Save protocol claims to local storage, needed to support page refreshes and multi tab browsing
        localStorage.setItem(key, JSON.stringify(deserialized));
    }
    /*
     * When UserManager.getUser is called, this supplies tokens from memory
     */
    getItem(key) {
        // Load protocol claims from local storage
        const rawData = localStorage.getItem(key);
        if (rawData) {
            // Update with in memory token values
            const deserialized = JSON.parse(rawData);
            this._setSensitiveDataWhenLoading(deserialized);
            return JSON.stringify(deserialized);
        }
        return null;
    }
    /*
     * Override the removeItem method to also clear tokens
     */
    removeItem(key) {
        localStorage.removeItem(key);
        this._accessToken = '';
        this._refreshToken = '';
        this._idToken = '';
    }
    /*
     * Return the length property
     */
    get length() {
        return localStorage.length;
    }
    /*
     * Forward to the indexer property
     */
    key(index) {
        return localStorage[index];
    }
    /*
     * Return the id token for use during logout
     */
    getIdToken() {
        return this._idToken;
    }
    /*
     * Avoid storing tokens in local storage
     */
    _removeSensitiveDataWhenStoring(tokenData) {
        // Save the updated access token
        this._accessToken = tokenData.access_token;
        // If there is a new refresh token then save it, otherwise maintain the existing one
        if (tokenData.refresh_token) {
            this._refreshToken = tokenData.refresh_token;
        }
        // If there is a new id token then save it, otherwise maintain the existing one
        if (tokenData.id_token) {
            this._idToken = tokenData.id_token;
        }
        // Remove tokens from HTML storage
        delete tokenData.access_token;
        delete tokenData.id_token;
        delete tokenData.refresh_token;
        if (tokenData.profile) {
            // Also remove profile claims from the id token, since our SPA gets this data from our API
            delete tokenData.profile.given_name;
            delete tokenData.profile.family_name;
            delete tokenData.profile.email;
            // Some providers also supply this value
            if (tokenData.profile.preferred_username) {
                delete tokenData.profile.preferred_username;
            }
        }
    }
    /*
     * Return our in memory tokens to the OIDC Client library
     */
    _setSensitiveDataWhenLoading(tokenData) {
        tokenData.access_token = this._accessToken;
        tokenData.id_token = this._idToken;
        tokenData.refresh_token = this._refreshToken;
    }
}


/***/ }),

/***/ "./plumbing/oauth/web/extended/webReverseProxyClient.ts":
/*!**************************************************************!*\
  !*** ./plumbing/oauth/web/extended/webReverseProxyClient.ts ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "WebReverseProxyClient": () => (/* binding */ WebReverseProxyClient)
/* harmony export */ });
/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ "../node_modules/axios/index.js");
/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _errors_errorHandler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../errors/errorHandler */ "./plumbing/errors/errorHandler.ts");
/* harmony import */ var _errors_errorConsoleReporter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../errors/errorConsoleReporter */ "./plumbing/errors/errorConsoleReporter.ts");
/* harmony import */ var _utilities_htmlStorageHelper__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utilities/htmlStorageHelper */ "./plumbing/utilities/htmlStorageHelper.ts");
/* harmony import */ var _utilities_urlHelper__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../utilities/urlHelper */ "./plumbing/utilities/urlHelper.ts");





/*
 * A helper class to deal with the web reverse proxy, its auth cookie, and its CSRF field
 */
class WebReverseProxyClient {
    constructor(clientId, webBaseUrl, reverseProxyPath) {
        this._responseBodyFieldName = 'csrf_field';
        this._requestHeaderFieldName = 'x-mycompany-finalspa-refresh-csrf';
        this._clientId = clientId;
        this._reverseProxyBaseUrl = _utilities_urlHelper__WEBPACK_IMPORTED_MODULE_4__.UrlHelper.append(webBaseUrl, reverseProxyPath);
    }
    /*
     * Override the prototype to send a CSRF request header
     * This accompanies the auth cookie issued by the web reverse proxy
     */
    initialise() {
        // Only do this once
        if (Object.isFrozen(XMLHttpRequest.prototype)) {
            return;
        }
        /* eslint-disable @typescript-eslint/no-this-alias */
        const that = this;
        const orig = XMLHttpRequest.prototype.open;
        XMLHttpRequest.prototype.open = function (method, url) {
            orig.call(this, method, url);
            that._sendCsrfFieldToProxy(this, url);
        };
        // Freeze the prototype so that malicious code is unable to intercept the bearer header
        Object.freeze(XMLHttpRequest.prototype);
    }
    /*
     * Return the location of the token endpoint
     */
    getTokenEndpoint() {
        return _utilities_urlHelper__WEBPACK_IMPORTED_MODULE_4__.UrlHelper.append(this._reverseProxyBaseUrl, 'token');
    }
    /*
     * Store the CSRF field when the web reverse proxy returns it in the Authorization Code Grant response
     */
    storeCsrfFieldFromProxy(response) {
        if (response[this._responseBodyFieldName]) {
            _utilities_htmlStorageHelper__WEBPACK_IMPORTED_MODULE_3__.HtmlStorageHelper.tokenEndpointCookieCsrfField = response[this._responseBodyFieldName];
        }
    }
    /*
     * Clean up web reverse proxy resources when the user session ends
     */
    async clearRefreshToken() {
        // Send a delete request to the reverse proxy's token endpoint to clear HTTP only cookies
        await this._sendWebReverseProxyRequest('DELETE', 'token');
        // Also remove the CSRF field from local storage
        _utilities_htmlStorageHelper__WEBPACK_IMPORTED_MODULE_3__.HtmlStorageHelper.removeTokenEndpointCookieCsrfField();
    }
    /*
     * Call the server and ask it to rewrite the refresh token in the auth cookie, to make it act expired
     */
    async expireRefreshToken() {
        await this._sendWebReverseProxyRequest('POST', 'expire');
    }
    /*
     * Do the common work when sending a request to the web reverse proxy
     */
    async _sendWebReverseProxyRequest(method, operationPath) {
        const url = _utilities_urlHelper__WEBPACK_IMPORTED_MODULE_4__.UrlHelper.append(this._reverseProxyBaseUrl, operationPath);
        try {
            // Use form URL encoded data
            const formData = new URLSearchParams();
            formData.append('client_id', this._clientId);
            // Define request options
            const options = {
                url,
                method,
                data: formData,
                headers: {
                    'content-type': 'application/x-www-form-urlencoded',
                },
            };
            // Call the web reverse proxy
            await axios__WEBPACK_IMPORTED_MODULE_0___default().request(options);
        }
        catch (e) {
            // Only output errors for this operation to the console
            const error = _errors_errorHandler__WEBPACK_IMPORTED_MODULE_1__.ErrorHandler.getFromHttpError(e, url, 'reverse_proxy_request');
            _errors_errorConsoleReporter__WEBPACK_IMPORTED_MODULE_2__.ErrorConsoleReporter.output(error);
        }
    }
    /*
     * Add a CSRF field to make it harder for attackers to send the web reverse proxy's auth cookie
     */
    _sendCsrfFieldToProxy(request, url) {
        if (url.toLowerCase().startsWith(this._reverseProxyBaseUrl)) {
            const value = _utilities_htmlStorageHelper__WEBPACK_IMPORTED_MODULE_3__.HtmlStorageHelper.tokenEndpointCookieCsrfField;
            if (value) {
                request.setRequestHeader(this._requestHeaderFieldName, value);
            }
        }
    }
}


/***/ }),

/***/ "./plumbing/oauth/web/utilities/customLogoutManager.ts":
/*!*************************************************************!*\
  !*** ./plumbing/oauth/web/utilities/customLogoutManager.ts ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CustomLogoutManager": () => (/* binding */ CustomLogoutManager)
/* harmony export */ });
/* harmony import */ var _errors_errorHandler__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../errors/errorHandler */ "./plumbing/errors/errorHandler.ts");
/* harmony import */ var _utilities_urlHelper__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utilities/urlHelper */ "./plumbing/utilities/urlHelper.ts");


/*
 * A class to manage logout via a vendor specific URL
 */
class CustomLogoutManager {
    constructor(webBaseUrl, configuration) {
        this._webBaseUrl = webBaseUrl;
        this._configuration = configuration;
    }
    /*
     * Format the Cognito specific logout URL
     */
    getCustomLogoutUrl() {
        // We currently only support this provider
        if (this._configuration.authority.indexOf('cognito') === -1) {
            throw _errors_errorHandler__WEBPACK_IMPORTED_MODULE_0__.ErrorHandler.getFromLogoutUnsupported();
        }
        // Form the full logout redirect URI
        const clientId = encodeURIComponent(this._configuration.clientId);
        const logoutPath = _utilities_urlHelper__WEBPACK_IMPORTED_MODULE_1__.UrlHelper.append(this._webBaseUrl, this._configuration.postLogoutRedirectUri);
        const postLogoutReturnUri = encodeURIComponent(logoutPath);
        // Upon return, loggedout.html redirects to https://web.authsamples.com/spa#loggedout
        return `${this._configuration.customLogoutEndpoint}?client_id=${clientId}&logout_uri=${postLogoutReturnUri}`;
    }
}


/***/ }),

/***/ "./plumbing/oauth/web/utilities/oidcLogger.ts":
/*!****************************************************!*\
  !*** ./plumbing/oauth/web/utilities/oidcLogger.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "OidcLogger": () => (/* binding */ OidcLogger)
/* harmony export */ });
/* harmony import */ var oidc_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! oidc-client */ "../node_modules/oidc-client/lib/oidc-client.min.js");
/* harmony import */ var oidc_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(oidc_client__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var url_parse__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! url-parse */ "../node_modules/url-parse/index.js");
/* harmony import */ var url_parse__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(url_parse__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utilities_htmlStorageHelper__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utilities/htmlStorageHelper */ "./plumbing/utilities/htmlStorageHelper.ts");



/*
 * A helper class to deal with calculating and storing the log level
 */
class OidcLogger {
    /*
     * Set the initial log details
     */
    constructor() {
        oidc_client__WEBPACK_IMPORTED_MODULE_0__.Log.logger = console;
        let level = this._getUrlLogLevel();
        if (!level) {
            level = this._getStoredLogLevel();
        }
        this._setLogLevel(level);
    }
    /*
     * If the URL has been updated such as to #log=debug, then update the OIDC Client logging level
     */
    updateLogLevelIfRequired() {
        const newLevel = this._getUrlLogLevel();
        if (newLevel && newLevel !== this._getStoredLogLevel()) {
            this._setLogLevel(newLevel);
            _utilities_htmlStorageHelper__WEBPACK_IMPORTED_MODULE_2__.HtmlStorageHelper.oidcLogLevel = newLevel;
        }
    }
    /*
     * Get the log level from a query parameter in the hash URL, such as #companies=2&log=info
     */
    _getUrlLogLevel() {
        if (location.hash.startsWith('#')) {
            const hashFragment = location.hash.substring(1).replace(/^\//, '');
            if (hashFragment) {
                const data = url_parse__WEBPACK_IMPORTED_MODULE_1___default()('?' + hashFragment, true);
                const logLevel = data.query.log;
                if (logLevel) {
                    return logLevel.toLowerCase();
                }
            }
        }
        return '';
    }
    /*
     * Get the value from session storage if it exists
     */
    _getStoredLogLevel() {
        return _utilities_htmlStorageHelper__WEBPACK_IMPORTED_MODULE_2__.HtmlStorageHelper.oidcLogLevel;
    }
    /*
     * Update the log level
     */
    _setLogLevel(level) {
        const data = {
            none: oidc_client__WEBPACK_IMPORTED_MODULE_0__.Log.NONE,
            error: oidc_client__WEBPACK_IMPORTED_MODULE_0__.Log.ERROR,
            warn: oidc_client__WEBPACK_IMPORTED_MODULE_0__.Log.WARN,
            info: oidc_client__WEBPACK_IMPORTED_MODULE_0__.Log.INFO,
            debug: oidc_client__WEBPACK_IMPORTED_MODULE_0__.Log.DEBUG,
        };
        const levelToSet = level || 'none';
        const numericLevel = data[levelToSet];
        if (numericLevel !== undefined) {
            oidc_client__WEBPACK_IMPORTED_MODULE_0__.Log.level = numericLevel;
        }
    }
}


/***/ }),

/***/ "./plumbing/oauth/web/utilities/tokenRenewalResponseHandler.ts":
/*!*********************************************************************!*\
  !*** ./plumbing/oauth/web/utilities/tokenRenewalResponseHandler.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TokenRenewalResponseHandler": () => (/* binding */ TokenRenewalResponseHandler)
/* harmony export */ });
/* harmony import */ var oidc_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! oidc-client */ "../node_modules/oidc-client/lib/oidc-client.min.js");
/* harmony import */ var oidc_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(oidc_client__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var url_parse__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! url-parse */ "../node_modules/url-parse/index.js");
/* harmony import */ var url_parse__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(url_parse__WEBPACK_IMPORTED_MODULE_1__);


/*
 * Receive iframe token renewal responses
 */
class TokenRenewalResponseHandler {
    constructor(configuration) {
        const settings = {
            authority: configuration.authority,
            client_id: configuration.clientId,
        };
        this._userManager = new oidc_client__WEBPACK_IMPORTED_MODULE_0__.UserManager(settings);
    }
    /*
     * Handle token renewal responses from the authorization server
     */
    async handleSilentTokenRenewalResponse() {
        // If the page loads with a state query parameter we classify it as an OAuth response
        const urlData = url_parse__WEBPACK_IMPORTED_MODULE_1___default()(location.href, true);
        if (urlData.query && urlData.query.state) {
            // Start processing of the authorization response on the iframe
            // Any errors are reported via the authenticator class of the main window
            await this._userManager.signinSilentCallback();
        }
    }
}


/***/ }),

/***/ "./plumbing/oauth/web/webAuthenticator.ts":
/*!************************************************!*\
  !*** ./plumbing/oauth/web/webAuthenticator.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "WebAuthenticator": () => (/* binding */ WebAuthenticator)
/* harmony export */ });
/* harmony import */ var oidc_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! oidc-client */ "../node_modules/oidc-client/lib/oidc-client.min.js");
/* harmony import */ var oidc_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(oidc_client__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var url_parse__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! url-parse */ "../node_modules/url-parse/index.js");
/* harmony import */ var url_parse__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(url_parse__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _errors_errorCodes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../errors/errorCodes */ "./plumbing/errors/errorCodes.ts");
/* harmony import */ var _errors_errorHandler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../errors/errorHandler */ "./plumbing/errors/errorHandler.ts");
/* harmony import */ var _utilities_concurrentActionHandler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utilities/concurrentActionHandler */ "./plumbing/utilities/concurrentActionHandler.ts");
/* harmony import */ var _utilities_htmlStorageHelper__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utilities/htmlStorageHelper */ "./plumbing/utilities/htmlStorageHelper.ts");
/* harmony import */ var _utilities_customLogoutManager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./utilities/customLogoutManager */ "./plumbing/oauth/web/utilities/customLogoutManager.ts");
/* harmony import */ var _utilities_oidcLogger__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./utilities/oidcLogger */ "./plumbing/oauth/web/utilities/oidcLogger.ts");








/*
 * A web authenticator with standard behaviour that can be extended via a subclass
 */
class WebAuthenticator {
    constructor(options) {
        this._options = options;
        this._oidcLogger = new _utilities_oidcLogger__WEBPACK_IMPORTED_MODULE_7__.OidcLogger();
        this._concurrencyHandler = new _utilities_concurrentActionHandler__WEBPACK_IMPORTED_MODULE_4__.ConcurrentActionHandler();
        this._setupCallbacks();
    }
    /*
     * Create the user manager during initialisation
     */
    async initialise() {
        // First create the user manager from settings
        this._userManager = this._createUserManager(this._options.settings);
        // When the user signs out from another browser tab, also remove tokens from this browser tab
        // This will only work if the Authorization Server has a check_session_iframe endpoint
        this._userManager.events.addUserSignedOut(async () => {
            this._userManager.removeUser();
            this._options.onLoggedOut();
        });
        // Allow any derived classes to do extra work
        await this._onInitialise();
    }
    /*
     * Get an access token if possible, which will retrieve it from storage
     */
    async getAccessToken() {
        // Get tokens from OIDC client
        const user = await this._userManager.getUser();
        if (user && user.access_token) {
            return user.access_token;
        }
        // Try to refresh the access token otherwise
        return await this.refreshAccessToken();
    }
    /*
     * Try to refresh an access token in a synchronised manner across multiple views
     */
    async refreshAccessToken() {
        // See if the user is stored on any browser tab
        let user = await this._userManager.getUser();
        if (user) {
            // The concurrency handler will only do the refresh work for the first UI view that requests it
            await this._concurrencyHandler.execute(this._performTokenRefresh);
            // Return the renewed access token if possible
            user = await this._userManager.getUser();
            if (user && user.access_token) {
                return user.access_token;
            }
        }
        // Trigger a login redirect if there are no unexpected errors but we cannot refresh
        throw _errors_errorHandler__WEBPACK_IMPORTED_MODULE_3__.ErrorHandler.getFromLoginRequired();
    }
    /*
     * Trigger the login redirect
     */
    async login() {
        try {
            // Get the identity provider to use or default to unknown
            const idp = this._getRuntimeIdentityProvider();
            const extraQueryParams = {};
            if (idp) {
                extraQueryParams[this._options.configuration.idpParameterName] = idp;
            }
            // Store data during the redirect
            const data = {
                hash: location.hash,
                idp,
            };
            // Start the login redirect
            await this._userManager.signinRedirect({
                state: data,
                extraQueryParams,
            });
        }
        catch (e) {
            // Handle OAuth specific errors, such as those calling the metadata endpoint
            throw _errors_errorHandler__WEBPACK_IMPORTED_MODULE_3__.ErrorHandler.getFromLoginOperation(e, _errors_errorCodes__WEBPACK_IMPORTED_MODULE_2__.ErrorCodes.loginRequestFailed);
        }
    }
    /*
     * Handle login responses on the main window
     */
    async handleLoginResponse() {
        var _a;
        // If the page loads with a state query parameter we classify it as an OAuth response
        const urlData = url_parse__WEBPACK_IMPORTED_MODULE_1___default()(location.href, true);
        if (urlData.query && urlData.query.state) {
            let redirectLocation = '#';
            try {
                // Only try to process a login response if the state exists
                const storedState = await ((_a = this._userManager.settings.stateStore) === null || _a === void 0 ? void 0 : _a.get(urlData.query.state));
                if (storedState) {
                    // Process the login response and send the authorization code grant message
                    const user = await this._userManager.signinRedirectCallback();
                    // If an identity provider query parameter was set, save it after a successful login
                    if (user.state.idp) {
                        _utilities_htmlStorageHelper__WEBPACK_IMPORTED_MODULE_5__.HtmlStorageHelper.identityProvider = user.state.idp;
                    }
                    // We will redirect to the hash URL before the login redirect
                    redirectLocation = user.state.hash;
                    // Delete any local storage redirect state older than 5 minutes for incomplete login redirects
                    await this._userManager.clearStaleState();
                }
            }
            catch (e) {
                // Handle and rethrow OAuth response errors
                throw _errors_errorHandler__WEBPACK_IMPORTED_MODULE_3__.ErrorHandler.getFromLoginOperation(e, _errors_errorCodes__WEBPACK_IMPORTED_MODULE_2__.ErrorCodes.loginResponseFailed);
            }
            finally {
                // Always replace the browser location, to remove OAuth details from back navigation
                history.replaceState({}, document.title, redirectLocation);
            }
        }
    }
    /*
     * Do the logout redirect
     */
    async logout() {
        var _a, _b;
        try {
            // Allow derived classes to perform clean up
            await this._onSessionExpiring();
            // See if the provider supports standards based logout
            const endSessionEndpoint = await this._userManager.metadataService.getEndSessionEndpoint();
            if (endSessionEndpoint) {
                // With some providers, during multi tab browsing we may not have an id token on the current tab
                const user = await ((_a = this._userManager) === null || _a === void 0 ? void 0 : _a.getUser());
                if (!user || !user.id_token) {
                    await this._userManager.removeUser();
                    throw _errors_errorHandler__WEBPACK_IMPORTED_MODULE_3__.ErrorHandler.getFromMissingIdToken();
                }
                // Clean up state then invoke the standard behaviour
                await this._userManager.signoutRedirect();
            }
            else {
                // Remove tokens from memory
                await ((_b = this._userManager) === null || _b === void 0 ? void 0 : _b.removeUser());
                // Then format the vendor specific URL and do the redirect
                const logoutManager = new _utilities_customLogoutManager__WEBPACK_IMPORTED_MODULE_6__.CustomLogoutManager(this._options.webBaseUrl, this._options.configuration);
                const fullLogoutUrl = logoutManager.getCustomLogoutUrl();
                location.replace(fullLogoutUrl);
            }
        }
        catch (e) {
            // Handle any technical errors
            throw _errors_errorHandler__WEBPACK_IMPORTED_MODULE_3__.ErrorHandler.getFromLogoutOperation(e, _errors_errorCodes__WEBPACK_IMPORTED_MODULE_2__.ErrorCodes.logoutRequestFailed);
        }
    }
    /*
     * This method is for testing only, to make the access token in storage act like it has expired
     */
    async expireAccessToken() {
        const user = await this._userManager.getUser();
        if (user) {
            user.access_token = 'x' + user.access_token + 'x';
            this._userManager.storeUser(user);
        }
    }
    /*
     * For testing, make the refresh token act like it is expired, when applicable
     */
    async expireRefreshToken() {
        // First expire the access token so that the next API call returns a 401
        await this.expireAccessToken();
        // Expire the refresh token if we have one
        const user = await this._userManager.getUser();
        if (user && user.refresh_token) {
            user.refresh_token = 'x' + user.refresh_token + 'x';
            this._userManager.storeUser(user);
        }
    }
    /*
     * Manage updates based on the user typing in a hash fragment URL such as #log=debug
     */
    updateLogLevelIfRequired() {
        this._oidcLogger.updateLogLevelIfRequired();
    }
    /*
     * The default implementation of creating the user manager can be overridden by derived classes
     */
    _createUserManager(settings) {
        return new oidc_client__WEBPACK_IMPORTED_MODULE_0__.UserManager(settings);
    }
    /*
     * Can be overridden by derived classes to do further initialisation
     */
    async _onInitialise() {
    }
    /*
     * Can be overridden by derived classes to do further work when a session expires
     */
    async _onSessionExpiring() {
    }
    /*
     * Ask OIDC client to silently renew the access token
     */
    async _performTokenRefresh() {
        try {
            // OIDC Client will either send a refresh token grant message or use a hidden iframe
            await this._userManager.signinSilent();
        }
        catch (e) {
            if (this._isSessionExpired(e)) {
                // Remove token data, which will result in triggering a login redirect later
                await this._userManager.removeUser();
                // Inform derived classes where applicable
                await this._onSessionExpiring();
            }
            else {
                // Rethrow other errors
                throw _errors_errorHandler__WEBPACK_IMPORTED_MODULE_3__.ErrorHandler.getFromTokenError(e, _errors_errorCodes__WEBPACK_IMPORTED_MODULE_2__.ErrorCodes.tokenRenewalError);
            }
        }
    }
    /*
     * Handle the idp query parameter when redirecting
     */
    _getRuntimeIdentityProvider() {
        // Use idp= to remove the identity provider from storage
        const urlData = url_parse__WEBPACK_IMPORTED_MODULE_1___default()(location.href, true);
        if (urlData.query && urlData.query.idp === '') {
            _utilities_htmlStorageHelper__WEBPACK_IMPORTED_MODULE_5__.HtmlStorageHelper.removeIdentityProvider();
            return '';
        }
        // Use a value such as idp=Okta to select an identity provider
        if (urlData.query && urlData.query.idp) {
            return urlData.query.idp;
        }
        // Use a local storage value if it exists
        return _utilities_htmlStorageHelper__WEBPACK_IMPORTED_MODULE_5__.HtmlStorageHelper.identityProvider;
    }
    /*
     * Treat certain errors as session expired
     */
    _isSessionExpired(e) {
        // An invalid_grant error code from the Authorization Server means an expired refresh token
        if (e.message === _errors_errorCodes__WEBPACK_IMPORTED_MODULE_2__.ErrorCodes.invalidGrant) {
            return true;
        }
        // A login_required error code means iframe silent renewal has failed
        if (e.error === _errors_errorCodes__WEBPACK_IMPORTED_MODULE_2__.ErrorCodes.loginRequired) {
            return true;
        }
        // This can happen when providers are not standards based, in which case we treat it as an invalid_grant
        // https://github.com/IdentityModel/oidc-client-js/issues/1058
        if (e.message === 'auth_time in id_token does not match original auth_time') {
            return true;
        }
        return false;
    }
    /*
     * Plumbing to ensure that the this parameter is available in async callbacks
     */
    _setupCallbacks() {
        this._performTokenRefresh = this._performTokenRefresh.bind(this);
    }
}


/***/ }),

/***/ "./plumbing/utilities/axiosUtils.ts":
/*!******************************************!*\
  !*** ./plumbing/utilities/axiosUtils.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AxiosUtils": () => (/* binding */ AxiosUtils)
/* harmony export */ });
/* harmony import */ var _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plumbing/errors/errorHandler */ "./plumbing/errors/errorHandler.ts");

/*
 * Utilities related to the Axios library
 */
class AxiosUtils {
    /*
     * Axios has a known issue where it swallows parse errors, so we throw an error in the way Axios should
     * https://github.com/axios/axios/issues/61
     */
    static checkJson(data) {
        if (typeof data !== 'object') {
            const error = _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_0__.ErrorHandler.getFromJsonParseError();
            error.response = {
                status: 200,
            };
            throw error;
        }
    }
}


/***/ }),

/***/ "./plumbing/utilities/concurrentActionHandler.ts":
/*!*******************************************************!*\
  !*** ./plumbing/utilities/concurrentActionHandler.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConcurrentActionHandler": () => (/* binding */ ConcurrentActionHandler)
/* harmony export */ });
/*
 * Used when multiple React UI fragments attempt an action that needs to be performed only once
 * Javascript is single threaded so we do not need to lock as in other languages
 */
class ConcurrentActionHandler {
    constructor() {
        this._callbacks = [];
    }
    /*
     * Run the supplied action once and return a promise while in progress
     */
    async execute(action) {
        // Create a promise through which to return the result
        const promise = new Promise((resolve, reject) => {
            const onSuccess = () => {
                resolve(null);
            };
            const onError = (error) => {
                reject(error);
            };
            this._callbacks.push([onSuccess, onError]);
        });
        // Only do the work for the first UI view that calls us
        const performAction = this._callbacks.length === 1;
        if (performAction) {
            try {
                // Do the work
                await action();
                // On success resolve all promises
                this._callbacks.forEach((c) => {
                    c[0]();
                });
            }
            catch (e) {
                // On failure resolve all promises with the same error
                this._callbacks.forEach((c) => {
                    c[1](e);
                });
            }
            // Reset once complete
            this._callbacks = [];
        }
        // Return the promise
        return promise;
    }
}


/***/ }),

/***/ "./plumbing/utilities/htmlStorageHelper.ts":
/*!*************************************************!*\
  !*** ./plumbing/utilities/htmlStorageHelper.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "HtmlStorageHelper": () => (/* binding */ HtmlStorageHelper)
/* harmony export */ });
/*
 * A utility class to keep our HTML storage organised
 */
class HtmlStorageHelper {
    /*
     * Return a CSRF field used for refresh token grant requests to the reverse proxy token endpoint
     */
    static get tokenEndpointCookieCsrfField() {
        const key = `${HtmlStorageHelper._prefix}${HtmlStorageHelper._cookieCsrfField}`;
        return localStorage.getItem(key) || '';
    }
    /*
     * Set the CSRF field used with the refresh token cookie
     */
    static set tokenEndpointCookieCsrfField(value) {
        const key = `${HtmlStorageHelper._prefix}${HtmlStorageHelper._cookieCsrfField}`;
        localStorage.setItem(key, value);
    }
    /*
     * Remove the CSRF field
     */
    static removeTokenEndpointCookieCsrfField() {
        const key = `${HtmlStorageHelper._prefix}${HtmlStorageHelper._cookieCsrfField}`;
        localStorage.removeItem(key);
    }
    /*
     * Return the preferred identity provider for the user
     */
    static get identityProvider() {
        const key = `${HtmlStorageHelper._prefix}${HtmlStorageHelper._identityProvider}`;
        return localStorage.getItem(key) || '';
    }
    /*
     * Record a federated login value supplied in a query parameter such as idp
     */
    static set identityProvider(value) {
        const key = `${HtmlStorageHelper._prefix}${HtmlStorageHelper._identityProvider}`;
        localStorage.setItem(key, value);
    }
    /*
     * Remove a federated login value
     */
    static removeIdentityProvider() {
        const key = `${HtmlStorageHelper._prefix}${HtmlStorageHelper._identityProvider}`;
        localStorage.removeItem(key);
    }
    /*
     * Get the session id for API requests from this browser tab
     */
    static get apiSessionId() {
        const key = `${HtmlStorageHelper._prefix}${HtmlStorageHelper._apiSessionKeyName}`;
        return sessionStorage.getItem(key) || '';
    }
    /*
     * Record a session id to be sent to the API for requests from this browser tab
     */
    static set apiSessionId(value) {
        const key = `${HtmlStorageHelper._prefix}${HtmlStorageHelper._apiSessionKeyName}`;
        sessionStorage.setItem(key, value);
    }
    /*
     * Get the log level for viewing OIDC client library details
     */
    static get oidcLogLevel() {
        const key = `${HtmlStorageHelper._prefix}${HtmlStorageHelper._oidcLogLevelKeyName}`;
        return localStorage.getItem(key) || '';
    }
    /*
     * Record the log level for viewing OIDC client library details
     */
    static set oidcLogLevel(value) {
        const key = `${HtmlStorageHelper._prefix}${HtmlStorageHelper._oidcLogLevelKeyName}`;
        localStorage.setItem(key, value);
    }
}
HtmlStorageHelper._prefix = 'finalspa.';
HtmlStorageHelper._isLoggedInField = 'loggedin';
HtmlStorageHelper._cookieCsrfField = 'cookie-csrf-field';
HtmlStorageHelper._identityProvider = 'identity-provider';
HtmlStorageHelper._apiSessionKeyName = 'api-sessionid';
HtmlStorageHelper._oidcLogLevelKeyName = 'oidc-log-level';


/***/ }),

/***/ "./plumbing/utilities/sessionManager.ts":
/*!**********************************************!*\
  !*** ./plumbing/utilities/sessionManager.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SessionManager": () => (/* binding */ SessionManager)
/* harmony export */ });
/* harmony import */ var guid_typescript__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! guid-typescript */ "../node_modules/guid-typescript/dist/guid.js");
/* harmony import */ var _htmlStorageHelper__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./htmlStorageHelper */ "./plumbing/utilities/htmlStorageHelper.ts");


/*
 * A custom session id header is added on each API call that is included in API logs
 */
class SessionManager {
    /*
     * Create the session when the browser tab is first created
     */
    static get() {
        let sessionId = _htmlStorageHelper__WEBPACK_IMPORTED_MODULE_1__.HtmlStorageHelper.apiSessionId;
        if (!sessionId) {
            sessionId = guid_typescript__WEBPACK_IMPORTED_MODULE_0__.Guid.create().toString();
            _htmlStorageHelper__WEBPACK_IMPORTED_MODULE_1__.HtmlStorageHelper.apiSessionId = sessionId;
        }
        return sessionId;
    }
}


/***/ }),

/***/ "./plumbing/utilities/urlHelper.ts":
/*!*****************************************!*\
  !*** ./plumbing/utilities/urlHelper.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "UrlHelper": () => (/* binding */ UrlHelper)
/* harmony export */ });
/*
 * A utility class to append URLs
 */
class UrlHelper {
    /*
     * In AWS we use a trailing / in the redirect URI, to prevent an unwanted redirect from /spa?code=xxx to /spa/
     */
    static append(baseUrl, path) {
        if (!baseUrl.endsWith('/') && !path.startsWith('/')) {
            return `${baseUrl}/${path}`;
        }
        return `${baseUrl}${path}`;
    }
}


/***/ }),

/***/ "./plumbing/utilities/userAgentHelper.ts":
/*!***********************************************!*\
  !*** ./plumbing/utilities/userAgentHelper.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "UserAgentHelper": () => (/* binding */ UserAgentHelper)
/* harmony export */ });
/*
 * A helper class to work with the user agent
 */
class UserAgentHelper {
    /*
     * Look for Android and wv
     */
    static isAndroidWebView() {
        const pattern = 'Android.*(wv|.0.0.0)';
        const regex = new RegExp(pattern);
        return !!navigator.userAgent.match(regex);
    }
    /*
     * Look for an iOS related string without Safari or Firefox
     * Note that up to date iPad web views use 'Macintosh' rather than 'iPad'
     */
    static isIosWebView() {
        const pattern = '(iPhone|iPod|iPad|Macintosh)(?!.*Safari)(?!.*Firefox)';
        const regex = new RegExp(pattern);
        return !!navigator.userAgent.match(regex);
    }
}


/***/ }),

/***/ "./views/companies/companiesContainer.tsx":
/*!************************************************!*\
  !*** ./views/companies/companiesContainer.tsx ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CompaniesContainer": () => (/* binding */ CompaniesContainer)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plumbing/errors/errorCodes */ "./plumbing/errors/errorCodes.ts");
/* harmony import */ var _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plumbing/errors/errorHandler */ "./plumbing/errors/errorHandler.ts");
/* harmony import */ var _plumbing_events_eventEmitter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plumbing/events/eventEmitter */ "./plumbing/events/eventEmitter.ts");
/* harmony import */ var _plumbing_events_eventNames__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plumbing/events/eventNames */ "./plumbing/events/eventNames.ts");
/* harmony import */ var _errors_errorSummaryView__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../errors/errorSummaryView */ "./views/errors/errorSummaryView.tsx");
/* harmony import */ var _utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utilities/apiViewNames */ "./views/utilities/apiViewNames.ts");
/* harmony import */ var _companiesDesktopView__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./companiesDesktopView */ "./views/companies/companiesDesktopView.tsx");
/* harmony import */ var _companiesMobileView__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./companiesMobileView */ "./views/companies/companiesMobileView.tsx");









/*
 * Render the companies view to replace the existing view
 */
class CompaniesContainer extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    constructor(props) {
        super(props);
        props.onLoading();
        this.state = {
            companies: [],
            error: null,
        };
        this._setupCallbacks();
    }
    /*
     * Render according to the current state and the type of device
     */
    render() {
        // Render an error on failure
        if (this.state.error) {
            return this._renderError();
        }
        // Display nothing until there is data
        if (this.state.companies.length === 0) {
            return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null));
        }
        // Display the desktop or mobile view otherwise
        const props = {
            companies: this.state.companies,
        };
        if (this.props.isMobileSize) {
            return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_companiesMobileView__WEBPACK_IMPORTED_MODULE_8__.CompaniesMobileView, Object.assign({}, props)));
        }
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_companiesDesktopView__WEBPACK_IMPORTED_MODULE_7__.CompaniesDesktopView, Object.assign({}, props)));
    }
    /*
     * Load data then listen for the reload event
     */
    async componentDidMount() {
        _plumbing_events_eventEmitter__WEBPACK_IMPORTED_MODULE_3__.EventEmitter.subscribe(_plumbing_events_eventNames__WEBPACK_IMPORTED_MODULE_4__.EventNames.ON_RELOAD_MAIN, this._loadData);
        await this._loadData(false);
    }
    /*
     * Unsubscribe when we unload
     */
    async componentWillUnmount() {
        _plumbing_events_eventEmitter__WEBPACK_IMPORTED_MODULE_3__.EventEmitter.unsubscribe(_plumbing_events_eventNames__WEBPACK_IMPORTED_MODULE_4__.EventNames.ON_RELOAD_MAIN, this._loadData);
    }
    /*
     * Get data from the API and update state
     */
    async _loadData(causeError) {
        try {
            this.setState({ error: null });
            // Do the load
            this.props.events.onViewLoading(_utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_6__.ApiViewNames.Main);
            const companies = await this.props.apiClient.getCompanyList({ causeError });
            this.props.events.onViewLoaded(_utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_6__.ApiViewNames.Main);
            this.setState({ companies });
        }
        catch (e) {
            // Update state
            const error = _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_2__.ErrorHandler.getFromException(e);
            this.setState({ companies: [], error });
            this.props.events.onViewLoadFailed(_utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_6__.ApiViewNames.Main, error);
        }
    }
    /*
     * Output error details if required
     */
    _renderError() {
        if (this.state.error.errorCode === _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_1__.ErrorCodes.loginRequired) {
            return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null));
        }
        const errorProps = {
            hyperlinkMessage: 'Problem Encountered in Companies View',
            dialogTitle: 'Companies View Error',
            error: this.state.error,
            centred: true,
        };
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_errors_errorSummaryView__WEBPACK_IMPORTED_MODULE_5__.ErrorSummaryView, Object.assign({}, errorProps)));
    }
    /*
     * Plumbing to ensure that the this parameter is available in async callbacks
     */
    _setupCallbacks() {
        this._loadData = this._loadData.bind(this);
    }
}


/***/ }),

/***/ "./views/companies/companiesDesktopView.tsx":
/*!**************************************************!*\
  !*** ./views/companies/companiesDesktopView.tsx ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CompaniesDesktopView": () => (/* binding */ CompaniesDesktopView)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");

/*
 * Render the companies view for the browser case
 */
class CompaniesDesktopView extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    constructor(props) {
        super(props);
    }
    /*
     * Render according to the current state
     */
    render() {
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'card border-0' },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row card-header' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-2 font-weight-bold text-center' }, "Account"),
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-2 font-weight-bold text-center' }, "Region"),
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-2' }),
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-2 font-weight-bold text-right' }, "Target USD"),
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-2 font-weight-bold text-right' }, "Investment USD"),
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-2 font-weight-bold text-right' }, "# Investors")),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'card-body' }, this.props.companies.map((company) => this._renderItem(company)))));
    }
    /*
     * Render a single company on a large screen
     */
    _renderItem(company) {
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row listRow', key: company.id },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-2 my-auto text-center' }, company.name),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-2 my-auto text-center' }, company.region),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-2 my-auto text-center' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", { href: `#company=${company.id}` }, "View Transactions")),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-2 my-auto highlightcolor font-weight-bold text-right' }, Number(company.targetUsd).toLocaleString()),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-2 my-auto highlightcolor font-weight-bold text-right' }, Number(company.investmentUsd).toLocaleString()),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-2 my-auto font-weight-bold text-right' }, company.noInvestors)));
    }
}


/***/ }),

/***/ "./views/companies/companiesMobileView.tsx":
/*!*************************************************!*\
  !*** ./views/companies/companiesMobileView.tsx ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "CompaniesMobileView": () => (/* binding */ CompaniesMobileView)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");

/*
 * Render the companies view for the mobile case
 */
class CompaniesMobileView extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    constructor(props) {
        super(props);
    }
    /*
     * Render according to the current state
     */
    render() {
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'card border-0' },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'card-header row' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-12 text-center mx-auto font-weight-bold' }, "Company List")),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'card-body' }, this.props.companies.map((company) => this._renderItem(company)))));
    }
    /*
     * Render a single company on a mobile device
     */
    _renderItem(company) {
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { key: company.id },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row mobileHeaderRow' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6 h4' },
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", { href: `#company=${company.id}` }, company.name)),
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6 h4 font-weight-bold' }, company.region)),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row mobileRow' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6' }, "Target USD"),
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6 highlightcolor font-weight-bold' }, Number(company.targetUsd).toLocaleString())),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row mobileRow' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6' }, "Investment USD"),
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6 highlightcolor font-weight-bold' }, Number(company.investmentUsd).toLocaleString())),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row mobileRow' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6' }, "# Investors"),
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6 font-weight-bold' }, company.noInvestors)),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("hr", null)));
    }
}


/***/ }),

/***/ "./views/errors/errorBoundary.tsx":
/*!****************************************!*\
  !*** ./views/errors/errorBoundary.tsx ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ErrorBoundary": () => (/* binding */ ErrorBoundary)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plumbing/errors/errorHandler */ "./plumbing/errors/errorHandler.ts");
/* harmony import */ var _errorSummaryView__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./errorSummaryView */ "./views/errors/errorSummaryView.tsx");



/*
 * Manages catching of rendering errors anywhere in the tree view during development
 */
class ErrorBoundary extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    /*
     * Update state so the next render will show the fallback UI
     */
    static getDerivedStateFromError(error) {
        return { error: _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_1__.ErrorHandler.getFromRenderError(error) };
    }
    /*
     * Initialise to the default state where there is no error and children are rendered
     */
    constructor(props) {
        super(props);
        this.state = {
            error: null,
        };
    }
    /*
     * Render children, or an error if a component has failed to render
     */
    render() {
        if (!this.state.error) {
            return this.props.children;
        }
        const errorProps = {
            hyperlinkMessage: 'Problem Encountered Rendering Views',
            dialogTitle: 'Rendering Error',
            error: this.state.error,
            centred: true,
        };
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_errorSummaryView__WEBPACK_IMPORTED_MODULE_2__.ErrorSummaryView, Object.assign({}, errorProps)));
    }
    /*
     * Catch errors and translate for display
     */
    componentDidCatch(error, errorInfo) {
        const details = _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_1__.ErrorHandler.getFromRenderError(error, errorInfo.componentStack);
        this.setState({ error: details });
    }
}


/***/ }),

/***/ "./views/errors/errorDetailsView.tsx":
/*!*******************************************!*\
  !*** ./views/errors/errorDetailsView.tsx ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ErrorDetailsView": () => (/* binding */ ErrorDetailsView)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var _plumbing_errors_errorFormatter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plumbing/errors/errorFormatter */ "./plumbing/errors/errorFormatter.ts");


/*
 * Manages rendering the error detailed view
 */
class ErrorDetailsView extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    constructor(props) {
        super(props);
    }
    /*
     * Output the error if it exists
     */
    render() {
        const formatter = new _plumbing_errors_errorFormatter__WEBPACK_IMPORTED_MODULE_1__.ErrorFormatter();
        const lines = formatter.getErrorLines(this.props.error);
        const stack = formatter.getErrorStack(this.props.error);
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'card border-0' },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-10 errorcolor largetext text-center' }, this.props.title),
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-2 text-right' },
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", { onClick: this.props.handleClose, type: 'button' }, "x"))),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row card-body' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-12' },
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'align-items-center mx-auto' },
                        lines.map((line) => this._renderErrorLine(line)),
                        this._renderErrorStack(stack))))));
    }
    /*
     * Render a single error line
     */
    _renderErrorLine(line) {
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row', key: line.id },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-4' }, line.label),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: `col-8 ${line.valueStyle} font-weight-bold` }, line.value)));
    }
    /*
     * Render stack trace details in debug builds
     */
    _renderErrorStack(line) {
        if (!line) {
            return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null));
        }
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null,
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row', key: line.id },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-4' }, "\u00A0"),
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-8' }, "\u00A0")),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row', key: line.id + 1 },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-4' }, line.label),
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-8 small' }, line.value))));
    }
}


/***/ }),

/***/ "./views/errors/errorSummaryView.tsx":
/*!*******************************************!*\
  !*** ./views/errors/errorSummaryView.tsx ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ErrorSummaryView": () => (/* binding */ ErrorSummaryView)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var react_modal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-modal */ "../node_modules/react-modal/lib/index.js");
/* harmony import */ var react_modal__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_modal__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plumbing/errors/errorCodes */ "./plumbing/errors/errorCodes.ts");
/* harmony import */ var _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plumbing/errors/errorHandler */ "./plumbing/errors/errorHandler.ts");
/* harmony import */ var _errorDetailsView__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./errorDetailsView */ "./views/errors/errorDetailsView.tsx");





/*
 * Manages rendering of error summary information
 */
class ErrorSummaryView extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    constructor(props) {
        super(props);
        // Initialise state and ensure that the error is the expected type for display
        this.state = {
            showDetails: false,
            error: props.error ? _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_3__.ErrorHandler.getFromException(props.error) : null,
        };
        this._setupCallbacks();
    }
    /*
     * If the error state changes we update state used for rendering
     */
    static getDerivedStateFromProps(nextProps, prevState) {
        // Return updated state
        if (nextProps.error !== prevState.error) {
            return {
                error: nextProps.error,
                showDetails: false,
            };
        }
        // Indicate no changes to state
        return null;
    }
    /*
     * Render the error hyperlink, and show the modal dialog when the user selects it
     */
    render() {
        // If there is no real error, do not render anything
        if (!this.state.error || this.state.error.errorCode === _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_2__.ErrorCodes.loginRequired) {
            return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null));
        }
        if (this.props.centred) {
            return (
            // Render the hyperlink as a centred row in the main UI
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null,
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row' },
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6 text-center mx-auto' }, this._renderHyperlink())),
                this._renderModalDialog()));
        }
        else {
            return (
            // Render the hyperlink in a more compact form, used for user info errors
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null,
                this._renderHyperlink(),
                this._renderModalDialog()));
        }
    }
    /*
     * Return the markup for the hyperlink
     */
    _renderHyperlink() {
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("a", { href: '#', className: 'errorcolor largetext text-center', onClick: this._handleSummaryClick }, this.props.hyperlinkMessage));
    }
    /*
     * Return the markup for the modal dialog
     */
    _renderModalDialog() {
        const errorDetailsProps = {
            title: this.props.dialogTitle,
            error: this.state.error,
            handleClose: this._handleDetailsDialogClose,
        };
        const customStyles = {
            overlay: {
                backgroundColor: 'lightgray',
            },
        };
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement((react_modal__WEBPACK_IMPORTED_MODULE_1___default()), { isOpen: this.state.showDetails, onRequestClose: this._handleDetailsDialogClose, contentLabel: this.props.dialogTitle, style: customStyles },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement(_errorDetailsView__WEBPACK_IMPORTED_MODULE_4__.ErrorDetailsView, Object.assign({}, errorDetailsProps))));
    }
    /*
     * Invoke error details when the link is clicked
     */
    _handleSummaryClick(event) {
        event.preventDefault();
        this.setState({ showDetails: true });
    }
    /*
     * Reset state when the dialog's close button is clicked
     */
    _handleDetailsDialogClose() {
        this.setState({ showDetails: false });
    }
    /*
     * Ensure that the this parameter is available in callbacks
     */
    _setupCallbacks() {
        this._handleSummaryClick = this._handleSummaryClick.bind(this);
        this._handleDetailsDialogClose = this._handleDetailsDialogClose.bind(this);
    }
}


/***/ }),

/***/ "./views/headings/headerButtonsView.tsx":
/*!**********************************************!*\
  !*** ./views/headings/headerButtonsView.tsx ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "HeaderButtonsView": () => (/* binding */ HeaderButtonsView)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");

/*
 * Render the header buttons
 */
class HeaderButtonsView extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    constructor(props) {
        super(props);
        this._longPressStartTime = null;
        this._longPressMilliseconds = 2000;
        this._setupCallbacks();
    }
    /*
     * Render buttons and callback the parent when clicked
     */
    render() {
        const disabled = !this.props.sessionButtonsEnabled;
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row' },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col col-one-fifth my-2 d-flex p-1' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", { onClick: this.props.handleHomeClick, className: 'btn btn-primary btn-block p-1' },
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement("small", null, "Home"))),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col col-one-fifth my-2 d-flex p-1', onTouchStart: this._handleReloadPress, onTouchEnd: this._handleReloadRelease, onMouseDown: this._handleReloadPress, onMouseUp: this._handleReloadRelease },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", { className: 'btn btn-primary btn-block p-1', disabled: disabled },
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement("small", null, "Reload Data"))),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col col-one-fifth my-2 d-flex p-1' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", { onClick: this.props.handleExpireAccessTokenClick, className: 'btn btn-primary btn-block p-1', disabled: disabled },
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement("small", null, "Expire Access Token"))),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col col-one-fifth my-2 d-flex p-1' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", { onClick: this.props.handleExpireRefreshTokenClick, className: 'btn btn-primary btn-block p-1', disabled: disabled },
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement("small", null, "Expire Refresh Token"))),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col col-one-fifth my-2 d-flex p-1' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("button", { onClick: this.props.handleLogoutClick, className: 'btn btn-primary btn-block p-1', disabled: disabled },
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement("small", null, "Logout")))));
    }
    /*
     * When refresh is clicked, measure the start time
     */
    _handleReloadPress() {
        if (!this.props.sessionButtonsEnabled) {
            return;
        }
        this._longPressStartTime = Date.now();
    }
    /*
     * The sample uses a long press to simulate an API 500 error, for demonstration purposes
     * Our solutions then demonstrate how it is reported in the UI and looked up via Elastic Search
     */
    _handleReloadRelease() {
        if (!this.props.sessionButtonsEnabled) {
            return;
        }
        if (this._isLongPress()) {
            // The button has been long pressed which we use as a trigger to simulate an exception
            // causeError = true means the UI to sends a header to the API to instruct it to simulate a 500 error
            this.props.handleReloadDataClick(true);
        }
        else {
            // In all other cases we reload data normally
            this.props.handleReloadDataClick(false);
        }
    }
    /*
     * A utility to calculate whether a long press has occurred
     */
    _isLongPress() {
        if (!this._longPressStartTime) {
            return false;
        }
        const timeTaken = Date.now() - this._longPressStartTime;
        this._longPressStartTime = null;
        return (timeTaken > this._longPressMilliseconds);
    }
    /*
     * Plumbing to ensure that the this parameter is available in async callbacks
     */
    _setupCallbacks() {
        this._handleReloadPress = this._handleReloadPress.bind(this);
        this._handleReloadRelease = this._handleReloadRelease.bind(this);
    }
}


/***/ }),

/***/ "./views/headings/headingView.tsx":
/*!****************************************!*\
  !*** ./views/headings/headingView.tsx ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "HeadingView": () => (/* binding */ HeadingView)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");

/*
 * Render the main heading
 */
class HeadingView extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    render() {
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("h2", null, "OAuth Demo App"));
    }
}


/***/ }),

/***/ "./views/headings/sessionView.tsx":
/*!****************************************!*\
  !*** ./views/headings/sessionView.tsx ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "SessionView": () => (/* binding */ SessionView)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var _plumbing_utilities_sessionManager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plumbing/utilities/sessionManager */ "./plumbing/utilities/sessionManager.ts");


/*
 * Render the session id used by API logs
 */
class SessionView extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    constructor(props) {
        super(props);
        this._sessionId = _plumbing_utilities_sessionManager__WEBPACK_IMPORTED_MODULE_1__.SessionManager.get();
    }
    /*
     * Render the session id hen data is loaded and API calls are in effect
     */
    render() {
        if (!this.props.isVisible) {
            return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null));
        }
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'sessionid text-right mx-auto' },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("small", null, `API Session Id: ${this._sessionId}`)));
    }
}


/***/ }),

/***/ "./views/headings/titleView.tsx":
/*!**************************************!*\
  !*** ./views/headings/titleView.tsx ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TitleView": () => (/* binding */ TitleView)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var _userInfo_userInfoView__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../userInfo/userInfoView */ "./views/userInfo/userInfoView.tsx");
/* harmony import */ var _headingView__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./headingView */ "./views/headings/headingView.tsx");



/*
 * Render the title area, which contains a heading and user info
 */
class TitleView extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    constructor(props) {
        super(props);
    }
    /*
     * Output child views
     */
    render() {
        // If there are no user info props yet, just display the title
        if (!this.props.userInfo) {
            return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-8 my-auto' },
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement(_headingView__WEBPACK_IMPORTED_MODULE_2__.HeadingView, null))));
        }
        // Otherwise render user info also
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row' },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-8 my-auto' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement(_headingView__WEBPACK_IMPORTED_MODULE_2__.HeadingView, null)),
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-4 my-auto' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement(_userInfo_userInfoView__WEBPACK_IMPORTED_MODULE_1__.UserInfoView, Object.assign({}, this.props.userInfo)))));
    }
}


/***/ }),

/***/ "./views/loginRequired/loginRequiredView.tsx":
/*!***************************************************!*\
  !*** ./views/loginRequired/loginRequiredView.tsx ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "LoginRequiredView": () => (/* binding */ LoginRequiredView)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");

/*
 * Render the simple login required view
 */
class LoginRequiredView extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    constructor(props) {
        super(props);
        props.onLoading();
    }
    /*
     * Render the simple logout view
     */
    render() {
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row' },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-12 text-center mx-auto' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("h6", null, "You are logged out - click HOME to sign in ..."))));
    }
}


/***/ }),

/***/ "./views/transactions/transactionsContainer.tsx":
/*!******************************************************!*\
  !*** ./views/transactions/transactionsContainer.tsx ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TransactionsContainer": () => (/* binding */ TransactionsContainer)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plumbing/errors/errorCodes */ "./plumbing/errors/errorCodes.ts");
/* harmony import */ var _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plumbing/errors/errorHandler */ "./plumbing/errors/errorHandler.ts");
/* harmony import */ var _plumbing_events_eventEmitter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plumbing/events/eventEmitter */ "./plumbing/events/eventEmitter.ts");
/* harmony import */ var _plumbing_events_eventNames__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plumbing/events/eventNames */ "./plumbing/events/eventNames.ts");
/* harmony import */ var _errors_errorSummaryView__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../errors/errorSummaryView */ "./views/errors/errorSummaryView.tsx");
/* harmony import */ var _utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utilities/apiViewNames */ "./views/utilities/apiViewNames.ts");
/* harmony import */ var _transactionsMainView__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./transactionsMainView */ "./views/transactions/transactionsMainView.tsx");








/*
 * Render the transactions view to replace the existing view
 */
class TransactionsContainer extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    /*
     * If the user changes the transaction to a new company the browser bar, the change is received here
     */
    static getDerivedStateFromProps(nextProps, prevState) {
        // Return updated state
        if (nextProps.match.params.id !== prevState.companyId) {
            return Object.assign(Object.assign({}, prevState), { companyId: nextProps.match.params.id });
        }
        // Indicate no changes to state
        return null;
    }
    /*
     * Initial state is received via the React Router
     */
    constructor(props) {
        super(props);
        props.onLoading();
        // Initialise state, and the initial company id is supplied via a path segment
        this.state = {
            companyId: this.props.match.params.id,
            error: null,
            data: null,
        };
        this._setupCallbacks();
    }
    /*
     * Render according to the current state and the type of device
     */
    render() {
        // Render an error on failure
        if (this.state.error) {
            return this._renderError();
        }
        // Display nothing until there is data
        if (!this.state.data) {
            return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null));
        }
        // Display the desktop or mobile view otherwise
        const props = {
            data: this.state.data,
        };
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_transactionsMainView__WEBPACK_IMPORTED_MODULE_7__.TransactionsMainView, Object.assign({}, props)));
    }
    /*
     * Load data then listen for the reload event
     */
    async componentDidMount() {
        _plumbing_events_eventEmitter__WEBPACK_IMPORTED_MODULE_3__.EventEmitter.subscribe(_plumbing_events_eventNames__WEBPACK_IMPORTED_MODULE_4__.EventNames.ON_RELOAD_MAIN, this._loadData);
        await this._loadData(false);
    }
    /*
     * Reload data when the user types a different company id in the browser
     */
    async componentDidUpdate(prevProps, prevState) {
        if (this.state.companyId !== prevState.companyId) {
            await this._loadData(false);
        }
    }
    /*
     * Unsubscribe when we unload
     */
    async componentWillUnmount() {
        _plumbing_events_eventEmitter__WEBPACK_IMPORTED_MODULE_3__.EventEmitter.unsubscribe(_plumbing_events_eventNames__WEBPACK_IMPORTED_MODULE_4__.EventNames.ON_RELOAD_MAIN, this._loadData);
    }
    /*
     * Get data from the API and update state
     */
    async _loadData(causeError) {
        try {
            this.setState({ error: null });
            // Get data from the API
            this.props.events.onViewLoading(_utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_6__.ApiViewNames.Main);
            const data = await this.props.apiClient.getCompanyTransactions(this.state.companyId, { causeError });
            this.props.events.onViewLoaded(_utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_6__.ApiViewNames.Main);
            this.setState({ data });
        }
        catch (e) {
            // Handle the error
            const error = _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_2__.ErrorHandler.getFromException(e);
            const isExpected = this._isExpectedApiError(error);
            if (isExpected) {
                // For 'expected' errors, return to the home view
                this.props.events.onViewLoaded(_utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_6__.ApiViewNames.Main);
                location.hash = '#';
            }
            else {
                // Indicate failure
                this.setState({ data: null, error });
                this.props.events.onViewLoadFailed(_utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_6__.ApiViewNames.Main, error);
            }
        }
    }
    /*
     * Output error details if required
     */
    _renderError() {
        if (this.state.error.errorCode === _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_1__.ErrorCodes.loginRequired) {
            return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null));
        }
        const errorProps = {
            hyperlinkMessage: 'Problem Encountered in Transactions View',
            dialogTitle: 'Transactions View Error',
            error: this.state.error,
            centred: true,
        };
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(_errors_errorSummaryView__WEBPACK_IMPORTED_MODULE_5__.ErrorSummaryView, Object.assign({}, errorProps)));
    }
    /*
     * Handle 'business errors' received from the API
     */
    _isExpectedApiError(error) {
        if (error.statusCode === 404 && error.errorCode === _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_1__.ErrorCodes.companyNotFound) {
            // User typed an id value outside of allowed company ids
            return true;
        }
        if (error.statusCode === 400 && error.errorCode === _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_1__.ErrorCodes.invalidCompanyId) {
            // User typed an invalid id such as 'abc'
            return true;
        }
        return false;
    }
    /*
     * Plumbing to ensure that the this parameter is available in async callbacks
     */
    _setupCallbacks() {
        this._loadData = this._loadData.bind(this);
    }
}


/***/ }),

/***/ "./views/transactions/transactionsMainView.tsx":
/*!*****************************************************!*\
  !*** ./views/transactions/transactionsMainView.tsx ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TransactionsMainView": () => (/* binding */ TransactionsMainView)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");

/*
 * Render the transactions main view
 */
class TransactionsMainView extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    constructor(props) {
        super(props);
    }
    /*
     * Render the data on a wide screen
     */
    render() {
        return this.props.data &&
            (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'card border-0' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'card-header row font-weight-bold' },
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-12 text-center mx-auto font-weight-bold' },
                        "Today's Transactions for ",
                        this.props.data.company.name)),
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row' }, this.props.data.transactions.map((transaction) => this._renderTransaction(transaction)))));
    }
    /*
     * Render a single transaction item
     */
    _renderTransaction(transaction) {
        return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-lg-4 col-md-6 col-xs-12', key: transaction.id },
            react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'card' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'card-body' },
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row' },
                        react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6' }, "Transaction Id"),
                        react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6 text-right valuecolor font-weight-bold' }, transaction.id)),
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row' },
                        react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6' }, "Investor Id"),
                        react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6 text-right valuecolor font-weight-bold' }, transaction.investorId)),
                    react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'row' },
                        react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6' }, "Amount USD"),
                        react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'col-6 text-right highlightcolor font-weight-bold' }, Number(transaction.amountUsd).toLocaleString()))))));
    }
}


/***/ }),

/***/ "./views/userInfo/userInfoView.tsx":
/*!*****************************************!*\
  !*** ./views/userInfo/userInfoView.tsx ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "UserInfoView": () => (/* binding */ UserInfoView)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "../node_modules/react/index.js");
/* harmony import */ var _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plumbing/errors/errorCodes */ "./plumbing/errors/errorCodes.ts");
/* harmony import */ var _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plumbing/errors/errorHandler */ "./plumbing/errors/errorHandler.ts");
/* harmony import */ var _plumbing_events_eventEmitter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plumbing/events/eventEmitter */ "./plumbing/events/eventEmitter.ts");
/* harmony import */ var _plumbing_events_eventNames__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plumbing/events/eventNames */ "./plumbing/events/eventNames.ts");
/* harmony import */ var _errors_errorSummaryView__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../errors/errorSummaryView */ "./views/errors/errorSummaryView.tsx");
/* harmony import */ var _utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utilities/apiViewNames */ "./views/utilities/apiViewNames.ts");







/*
 * A simple component to render the logged in user
 */
class UserInfoView extends react__WEBPACK_IMPORTED_MODULE_0__.Component {
    /*
     * If the logged out state changes we update state used for rendering
     */
    static getDerivedStateFromProps(nextProps, prevState) {
        // Return updated state
        if (nextProps.shouldLoad !== prevState.shouldLoad) {
            return Object.assign(Object.assign({}, prevState), { shouldLoad: nextProps.shouldLoad });
        }
        // Indicate no changes to state
        return null;
    }
    constructor(props) {
        super(props);
        this.state = {
            shouldLoad: props.shouldLoad,
            claims: null,
            error: null,
        };
        this._setupCallbacks();
    }
    /*
     * Render user info both before and after received
     */
    render() {
        // Render errors if there are technical problems getting user info
        if (this.state.error && this.state.error.errorCode !== _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_1__.ErrorCodes.loginRequired) {
            const errorProps = {
                hyperlinkMessage: 'Problem Encountered',
                dialogTitle: 'User Info Error',
                error: this.state.error,
                centred: false,
            };
            return (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'text-right mx-auto' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement(_errors_errorSummaryView__WEBPACK_IMPORTED_MODULE_5__.ErrorSummaryView, Object.assign({}, errorProps))));
        }
        // Render nothing when logged out
        if (!this.state.shouldLoad || !this.state.claims) {
            return (react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null));
        }
        // Render the logged in user name otherwise
        const name = `${this.state.claims.givenName} ${this.state.claims.familyName}`;
        return this.state.claims &&
            (react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", { className: 'text-right mx-auto' },
                react__WEBPACK_IMPORTED_MODULE_0__.createElement("p", { className: 'font-weight-bold' }, name)));
    }
    /*
     * Load data then listen for the reload event
     */
    async componentDidMount() {
        _plumbing_events_eventEmitter__WEBPACK_IMPORTED_MODULE_3__.EventEmitter.subscribe(_plumbing_events_eventNames__WEBPACK_IMPORTED_MODULE_4__.EventNames.ON_RELOAD_USERINFO, this._loadData);
        await this._loadData(false);
    }
    /*
     * Unsubscribe when we unload
     */
    async componentWillUnmount() {
        _plumbing_events_eventEmitter__WEBPACK_IMPORTED_MODULE_3__.EventEmitter.unsubscribe(_plumbing_events_eventNames__WEBPACK_IMPORTED_MODULE_4__.EventNames.ON_RELOAD_USERINFO, this._loadData);
    }
    /*
     * Reload data when the user chooses to resume from the logged out page
     */
    async componentDidUpdate(prevProps, prevState) {
        if (!prevState.shouldLoad && this.state.shouldLoad) {
            await this._loadData(false);
        }
    }
    /*
     * Load data when requested
     */
    async _loadData(causeError) {
        try {
            // We do not load when the logged out view is active
            if (!this.state.shouldLoad) {
                this.props.events.onViewLoaded(_utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_6__.ApiViewNames.UserInfo);
                return;
            }
            this.setState({ error: null });
            // Get user info
            this.props.events.onViewLoading(_utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_6__.ApiViewNames.UserInfo);
            const claims = await this.props.apiClient.getUserInfo({ causeError });
            this.props.events.onViewLoaded(_utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_6__.ApiViewNames.UserInfo);
            this.setState({ claims });
        }
        catch (e) {
            const error = _plumbing_errors_errorHandler__WEBPACK_IMPORTED_MODULE_2__.ErrorHandler.getFromException(e);
            this.setState({ claims: null, error });
            this.props.events.onViewLoadFailed(_utilities_apiViewNames__WEBPACK_IMPORTED_MODULE_6__.ApiViewNames.UserInfo, error);
        }
    }
    /*
     * Plumbing to ensure that the this parameter is available in async callbacks
     */
    _setupCallbacks() {
        this._loadData = this._loadData.bind(this);
    }
}


/***/ }),

/***/ "./views/utilities/apiViewEvents.ts":
/*!******************************************!*\
  !*** ./views/utilities/apiViewEvents.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ApiViewEvents": () => (/* binding */ ApiViewEvents)
/* harmony export */ });
/* harmony import */ var _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plumbing/errors/errorCodes */ "./plumbing/errors/errorCodes.ts");
/* harmony import */ var _apiViewNames__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./apiViewNames */ "./views/utilities/apiViewNames.ts");


/*
 * A helper class to keep track of views that call APIs and whether a login_required error has been received
 */
class ApiViewEvents {
    /*
     * Set the initial state at construction
     */
    constructor(onLoginRequiredAction, onMainLoadStateChanged) {
        this._views = [];
        this._loginRequired = false;
        this._onLoginRequiredAction = onLoginRequiredAction;
        this._onMainLoadStateChanged = onMainLoadStateChanged;
        this._setupCallbacks();
    }
    /*
     * Each view is added along with an initial unloaded state
     */
    addView(name) {
        this._views.push([name, false]);
    }
    /*
     * Handle loading notifications, which will disable the header buttons
     */
    onViewLoading(name) {
        this._updateLoadState(name, false);
        if (name === _apiViewNames__WEBPACK_IMPORTED_MODULE_1__.ApiViewNames.Main) {
            this._onMainLoadStateChanged(false);
        }
    }
    /*
     * Update state when loaded, which may trigger a login redirect once all views are loaded
     */
    onViewLoaded(name) {
        this._updateLoadState(name, true);
        if (name === _apiViewNames__WEBPACK_IMPORTED_MODULE_1__.ApiViewNames.Main) {
            this._onMainLoadStateChanged(true);
        }
        this._triggerLoginIfRequired();
    }
    /*
     * Update state when there is a load error, which may trigger a login redirect once all views are loaded
     */
    onViewLoadFailed(name, error) {
        this._updateLoadState(name, true);
        if (error.errorCode === _plumbing_errors_errorCodes__WEBPACK_IMPORTED_MODULE_0__.ErrorCodes.loginRequired) {
            this._loginRequired = true;
        }
        this._triggerLoginIfRequired();
    }
    /*
     * Reset state when the Reload Data button is clicked
     */
    clearState() {
        this._views.forEach((i) => i[1] = false);
        this._loginRequired = false;
    }
    /*
     * Update whether a view has finished trying to load
     */
    _updateLoadState(name, value) {
        const found = this._views.find(i => i[0] === name);
        if (found) {
            found[1] = value;
        }
    }
    /*
     * If all views are loaded and one or more has reported login required, then trigger a redirect
     */
    _triggerLoginIfRequired() {
        const allViewsLoaded = this._views.filter(i => i[1] === true).length === this._views.length;
        if (allViewsLoaded && this._loginRequired) {
            this._onLoginRequiredAction();
        }
    }
    /*
     * Plumbing to ensure that the this parameter is available in async callbacks
     */
    _setupCallbacks() {
        this.onViewLoading = this.onViewLoading.bind(this);
        this.onViewLoaded = this.onViewLoaded.bind(this);
        this.onViewLoadFailed = this.onViewLoadFailed.bind(this);
    }
}


/***/ }),

/***/ "./views/utilities/apiViewNames.ts":
/*!*****************************************!*\
  !*** ./views/utilities/apiViewNames.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ApiViewNames": () => (/* binding */ ApiViewNames)
/* harmony export */ });
/*
 * Constant values used with views that get API data
 */
class ApiViewNames {
}
// A view that occupies the main view area
ApiViewNames.Main = 'main';
// The user info view
ApiViewNames.UserInfo = 'userInfo';


/***/ }),

/***/ "./views/utilities/routeHelper.ts":
/*!****************************************!*\
  !*** ./views/utilities/routeHelper.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "RouteHelper": () => (/* binding */ RouteHelper)
/* harmony export */ });
/*
 * A utility class to determine the current route
 */
class RouteHelper {
    /*
     * Return true if we are not in the logged out view or the transactions view
     */
    static isInHomeView() {
        return (location.hash.indexOf('loggedout') === -1) && (location.hash.indexOf('company=') === -1);
    }
}


/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		if(__webpack_module_cache__[moduleId]) {
/******/ 			return __webpack_module_cache__[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			id: moduleId,
/******/ 			loaded: false,
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = __webpack_modules__;
/******/ 	
/******/ 	// the startup function
/******/ 	// It's empty as some runtime module handles the default behavior
/******/ 	__webpack_require__.x = x => {};
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/node module decorator */
/******/ 	(() => {
/******/ 		__webpack_require__.nmd = (module) => {
/******/ 			module.paths = [];
/******/ 			if (!module.children) module.children = [];
/******/ 			return module;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/jsonp chunk loading */
/******/ 	(() => {
/******/ 		// no baseURI
/******/ 		
/******/ 		// object to store loaded and loading chunks
/******/ 		// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 		// Promise = chunk loading, 0 = chunk loaded
/******/ 		var installedChunks = {
/******/ 			"app": 0
/******/ 		};
/******/ 		
/******/ 		var deferredModules = [
/******/ 			["./index.tsx","vendor"]
/******/ 		];
/******/ 		// no chunk on demand loading
/******/ 		
/******/ 		// no prefetching
/******/ 		
/******/ 		// no preloaded
/******/ 		
/******/ 		// no HMR
/******/ 		
/******/ 		// no HMR manifest
/******/ 		
/******/ 		var checkDeferredModules = x => {};
/******/ 		
/******/ 		// install a JSONP callback for chunk loading
/******/ 		var webpackJsonpCallback = (parentChunkLoadingFunction, data) => {
/******/ 			var [chunkIds, moreModules, runtime, executeModules] = data;
/******/ 			// add "moreModules" to the modules object,
/******/ 			// then flag all "chunkIds" as loaded and fire callback
/******/ 			var moduleId, chunkId, i = 0, resolves = [];
/******/ 			for(;i < chunkIds.length; i++) {
/******/ 				chunkId = chunkIds[i];
/******/ 				if(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {
/******/ 					resolves.push(installedChunks[chunkId][0]);
/******/ 				}
/******/ 				installedChunks[chunkId] = 0;
/******/ 			}
/******/ 			for(moduleId in moreModules) {
/******/ 				if(__webpack_require__.o(moreModules, moduleId)) {
/******/ 					__webpack_require__.m[moduleId] = moreModules[moduleId];
/******/ 				}
/******/ 			}
/******/ 			if(runtime) runtime(__webpack_require__);
/******/ 			if(parentChunkLoadingFunction) parentChunkLoadingFunction(data);
/******/ 			while(resolves.length) {
/******/ 				resolves.shift()();
/******/ 			}
/******/ 		
/******/ 			// add entry modules from loaded chunk to deferred list
/******/ 			if(executeModules) deferredModules.push.apply(deferredModules, executeModules);
/******/ 		
/******/ 			// run deferred modules when all chunks ready
/******/ 			return checkDeferredModules();
/******/ 		}
/******/ 		
/******/ 		var chunkLoadingGlobal = self["webpackChunk"] = self["webpackChunk"] || [];
/******/ 		chunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));
/******/ 		chunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));
/******/ 		
/******/ 		function checkDeferredModulesImpl() {
/******/ 			var result;
/******/ 			for(var i = 0; i < deferredModules.length; i++) {
/******/ 				var deferredModule = deferredModules[i];
/******/ 				var fulfilled = true;
/******/ 				for(var j = 1; j < deferredModule.length; j++) {
/******/ 					var depId = deferredModule[j];
/******/ 					if(installedChunks[depId] !== 0) fulfilled = false;
/******/ 				}
/******/ 				if(fulfilled) {
/******/ 					deferredModules.splice(i--, 1);
/******/ 					result = __webpack_require__(__webpack_require__.s = deferredModule[0]);
/******/ 				}
/******/ 			}
/******/ 			if(deferredModules.length === 0) {
/******/ 				__webpack_require__.x();
/******/ 				__webpack_require__.x = x => {};
/******/ 			}
/******/ 			return result;
/******/ 		}
/******/ 		var startup = __webpack_require__.x;
/******/ 		__webpack_require__.x = () => {
/******/ 			// reset startup function so it can be called again when more startup code is added
/******/ 			__webpack_require__.x = startup || (x => {});
/******/ 			return (checkDeferredModules = checkDeferredModulesImpl)();
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// run startup
/******/ 	var __webpack_exports__ = __webpack_require__.x();
/******/ 	
/******/ })()
;
//# sourceMappingURL=app.bundle.js.map